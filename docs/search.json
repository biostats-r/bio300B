[
  {
    "objectID": "packages_used.html",
    "href": "packages_used.html",
    "title": "Bio300b packages",
    "section": "",
    "text": "Annotated list of packages used in Bio300B, showing how we have used the package in this course (some of the packages have functionality we have not explored)."
  },
  {
    "objectID": "packages_used.html#general",
    "href": "packages_used.html#general",
    "title": "Bio300b packages",
    "section": "General",
    "text": "General\n\nBase R packages, base, stats, utils etc\ntidyverse meta package that loads tidyr, dplyr, ggplot2 etc."
  },
  {
    "objectID": "packages_used.html#data",
    "href": "packages_used.html#data",
    "title": "Bio300b packages",
    "section": "data",
    "text": "data\n\npalmerpenguins penguins"
  },
  {
    "objectID": "packages_used.html#help",
    "href": "packages_used.html#help",
    "title": "Bio300b packages",
    "section": "help",
    "text": "help\n\nintroverse Resources for learning R and tidyverse (gh)"
  },
  {
    "objectID": "packages_used.html#data-manipulation",
    "href": "packages_used.html#data-manipulation",
    "title": "Bio300b packages",
    "section": "Data manipulation",
    "text": "Data manipulation\n\ntibble improved data frames (TV)\nreadr importing data (TV)\njanitor cleaning data\ntidyr tidying data (TV)\ndplyr manipulating data in data.frames/tibbles (TV)\nlubridate manipulating dates (tv)"
  },
  {
    "objectID": "packages_used.html#visualisation",
    "href": "packages_used.html#visualisation",
    "title": "Bio300b packages",
    "section": "Visualisation",
    "text": "Visualisation\n\nggplot2 data visualisation (TV)\nggbeeswarm ggplot geoms for violin-plot shaped jitter\ngghighlight highlight points and lines in ggplot\nggfortify lm model diagnostics\nGGally pairs plot\npatchwork combine plots\ncolorBlindness simulate colour-blindness\n\n\nMaps\n\nrnaturalearth map data\nggOceanMap ocean map data\nggmap make a map with tiles\nterra import and process raster data\nsf import, process and plot geospatial data\nggspatial help plot and annotate geospatial data"
  },
  {
    "objectID": "packages_used.html#communication",
    "href": "packages_used.html#communication",
    "title": "Bio300b packages",
    "section": "Communication",
    "text": "Communication\n\nquarto dynamic, executable, reproducible documents with markdown\nknitr helper functions for quarto documents\nenglish numbers as words\ngt publication ready tables"
  },
  {
    "objectID": "packages_used.html#reproducibility",
    "href": "packages_used.html#reproducibility",
    "title": "Bio300b packages",
    "section": "Reproducibility",
    "text": "Reproducibility\n\nconflicted settle conflicts between packages\nhere finding your project root for importing/exporting files\nremotes install packages from github\nusethis help set-up R and RStudio"
  },
  {
    "objectID": "lectures.html",
    "href": "lectures.html",
    "title": "Lecture Slides",
    "section": "",
    "text": "Shortcut keys for quarto presentations:\nAll links open the lecture notes in a new browser tab."
  },
  {
    "objectID": "lectures.html#bio300b-logistics",
    "href": "lectures.html#bio300b-logistics",
    "title": "Lecture Slides",
    "section": "Bio300b logistics",
    "text": "Bio300b logistics\nThe who, what, where and when of Bio300b"
  },
  {
    "objectID": "lectures.html#lecture-1-data-lifecycle",
    "href": "lectures.html#lecture-1-data-lifecycle",
    "title": "Lecture Slides",
    "section": "Lecture 1: Data lifecycle",
    "text": "Lecture 1: Data lifecycle\nFollowing data from birth, trying to avoid data death in the data lifecycle."
  },
  {
    "objectID": "lectures.html#lecture-2-using-r",
    "href": "lectures.html#lecture-2-using-r",
    "title": "Lecture Slides",
    "section": "Lecture 2: Using R",
    "text": "Lecture 2: Using R\nAn introduction to using R."
  },
  {
    "objectID": "lectures.html#lecture-3-data-manipulation",
    "href": "lectures.html#lecture-3-data-manipulation",
    "title": "Lecture Slides",
    "section": "Lecture 3: Data manipulation",
    "text": "Lecture 3: Data manipulation\nUsing the tidyverse to load, tidy and process data."
  },
  {
    "objectID": "lectures.html#lecture-4-data-visualisation",
    "href": "lectures.html#lecture-4-data-visualisation",
    "title": "Lecture Slides",
    "section": "Lecture 4: Data visualisation",
    "text": "Lecture 4: Data visualisation\nUsing ggplot2 to make beautiful figures."
  },
  {
    "objectID": "lectures.html#lecture-5-experimental-design",
    "href": "lectures.html#lecture-5-experimental-design",
    "title": "Lecture Slides",
    "section": "Lecture 5: Experimental design",
    "text": "Lecture 5: Experimental design\nExperimental design."
  },
  {
    "objectID": "lectures.html#lecture-6-descriptive-statistics",
    "href": "lectures.html#lecture-6-descriptive-statistics",
    "title": "Lecture Slides",
    "section": "Lecture 6: Descriptive statistics",
    "text": "Lecture 6: Descriptive statistics\nDescriptive statistics."
  },
  {
    "objectID": "lectures.html#lecture-7-linear-regression",
    "href": "lectures.html#lecture-7-linear-regression",
    "title": "Lecture Slides",
    "section": "Lecture 7: Linear regression",
    "text": "Lecture 7: Linear regression\nCorrelations and linear regression with continuous and categorical predictors."
  },
  {
    "objectID": "lectures.html#lecture-8-multiple-linear-regression",
    "href": "lectures.html#lecture-8-multiple-linear-regression",
    "title": "Lecture Slides",
    "section": "Lecture 8: Multiple linear regression",
    "text": "Lecture 8: Multiple linear regression\nFor models with more than one predictor, you need multiple regression."
  },
  {
    "objectID": "lectures.html#lecture-9-generalised-linear-models",
    "href": "lectures.html#lecture-9-generalised-linear-models",
    "title": "Lecture Slides",
    "section": "Lecture 9: Generalised linear models",
    "text": "Lecture 9: Generalised linear models\nGot Poisson or binomial data? Use Generalised linear models."
  },
  {
    "objectID": "lectures.html#lecture-10-mixed-effect-models",
    "href": "lectures.html#lecture-10-mixed-effect-models",
    "title": "Lecture Slides",
    "section": "Lecture 10: Mixed effect models",
    "text": "Lecture 10: Mixed effect models\nClustered data? You need to use a mixed effect model."
  },
  {
    "objectID": "lectures.html#lecture-11-survival-analysis",
    "href": "lectures.html#lecture-11-survival-analysis",
    "title": "Lecture Slides",
    "section": "Lecture 11: Survival Analysis",
    "text": "Lecture 11: Survival Analysis\nDo you data show the time or distance until event happens? Maybe you need survival analysis."
  },
  {
    "objectID": "lecture_11_survival_summary.html#survival-analysis",
    "href": "lecture_11_survival_summary.html#survival-analysis",
    "title": "Survival analysis and Summary",
    "section": "Survival analysis",
    "text": "Survival analysis\nHow long (or far) until an event happens\n\nHow long before a seed germinates\nHow long before a patient dies after diagnosis\nHow many jumps can a horse clear at a racecourse\n\nData are typically right censored.\nsurvival package"
  },
  {
    "objectID": "lecture_11_survival_summary.html#survival-data",
    "href": "lecture_11_survival_summary.html#survival-data",
    "title": "Survival analysis and Summary",
    "section": "Survival data",
    "text": "Survival data\nResponse data\n\ntime\nstatus (0/1, TRUE/FALSE)\n\n\nlibrary(survival)\ndata(lung)\nlung |&gt; slice(1:10)\n\n   inst time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1     3  306      2  74   1       1       90       100     1175      NA\n2     3  455      2  68   1       0       90        90     1225      15\n3     3 1010      1  56   1       0       90        90       NA      15\n4     5  210      2  57   1       1       90        60     1150      11\n5     1  883      2  60   1       0      100        90       NA       0\n6    12 1022      1  74   1       1       50        80      513       0\n7     7  310      2  68   2       2       70        60      384      10\n8    11  361      2  71   2       2       60        80      538       1\n9     1  218      2  53   1       1       70        80      825      16\n10    7  166      2  61   1       2       70        70      271      34"
  },
  {
    "objectID": "lecture_11_survival_summary.html#survival-response",
    "href": "lecture_11_survival_summary.html#survival-response",
    "title": "Survival analysis and Summary",
    "section": "Survival response",
    "text": "Survival response\n\nindicates censored data\n\n\nSurv(lung$time, lung$status)\n\n\n\n [1]  306   455  1010+  210   883  1022+  310   361   218   166   170   654 \n[13]  728    71   567   144   613   707    61    88   301    81   624   371 \n[25]  394   520   574   118   390    12"
  },
  {
    "objectID": "lecture_11_survival_summary.html#fitting-a-model",
    "href": "lecture_11_survival_summary.html#fitting-a-model",
    "title": "Survival analysis and Summary",
    "section": "Fitting a model",
    "text": "Fitting a model\n\nlung &lt;- lung |&gt; \n  mutate(sex = factor(sex, levels = 1:2, labels = c(\"male\", \"female\")))\nmod_surv &lt;- survfit(Surv(time, status) ~ sex, data = lung)\n\nmod_surv\n\nCall: survfit(formula = Surv(time, status) ~ sex, data = lung)\n\n             n events median 0.95LCL 0.95UCL\nsex=male   138    112    270     212     310\nsex=female  90     53    426     348     550"
  },
  {
    "objectID": "lecture_11_survival_summary.html#plotting-a-model",
    "href": "lecture_11_survival_summary.html#plotting-a-model",
    "title": "Survival analysis and Summary",
    "section": "plotting a model",
    "text": "plotting a model\n\nKaplan-Meier curve\n‘+’ mark censored data\n\n\nlibrary(ggfortify)\nautoplot(mod_surv)"
  },
  {
    "objectID": "lecture_11_survival_summary.html#testing-a-model",
    "href": "lecture_11_survival_summary.html#testing-a-model",
    "title": "Survival analysis and Summary",
    "section": "Testing a model",
    "text": "Testing a model\n\nlogrank (Mantel-Cox) test\n\n\nmod_diff &lt;- survdiff(Surv(time, status) ~ sex, data = lung)\nmod_diff\n\nCall:\nsurvdiff(formula = Surv(time, status) ~ sex, data = lung)\n\n             N Observed Expected (O-E)^2/E (O-E)^2/V\nsex=male   138      112     91.6      4.55      10.3\nsex=female  90       53     73.4      5.68      10.3\n\n Chisq= 10.3  on 1 degrees of freedom, p= 0.001"
  },
  {
    "objectID": "lecture_11_survival_summary.html#survivorship-curve",
    "href": "lecture_11_survival_summary.html#survivorship-curve",
    "title": "Survival analysis and Summary",
    "section": "Survivorship curve",
    "text": "Survivorship curve\nShape of the survival curve"
  },
  {
    "objectID": "lecture_11_survival_summary.html#hazard-the-instantaneous-risk-of-death",
    "href": "lecture_11_survival_summary.html#hazard-the-instantaneous-risk-of-death",
    "title": "Survival analysis and Summary",
    "section": "Hazard: The instantaneous risk of death",
    "text": "Hazard: The instantaneous risk of death\n\nm_ll &lt;- survreg(Surv(time, status) ~ age + sex, \n                data = lung,\n                dist = \"loglogistic\")\nsummary(m_ll)\n\n\nCall:\nsurvreg(formula = Surv(time, status) ~ age + sex, data = lung, \n    dist = \"loglogistic\")\n               Value Std. Error     z       p\n(Intercept)  6.39982    0.49256 12.99 &lt; 2e-16\nage         -0.01401    0.00771 -1.82 0.06946\nsexfemale    0.47751    0.14036  3.40 0.00067\nLog(scale)  -0.56991    0.06543 -8.71 &lt; 2e-16\n\nScale= 0.566 \n\nLog logistic distribution\nLoglik(model)= -1152.9   Loglik(intercept only)= -1160.9\n    Chisq= 16.07 on 2 degrees of freedom, p= 0.00032 \nNumber of Newton-Raphson Iterations: 4 \nn= 228"
  },
  {
    "objectID": "lecture_11_survival_summary.html#summary",
    "href": "lecture_11_survival_summary.html#summary",
    "title": "Survival analysis and Summary",
    "section": "Summary",
    "text": "Summary"
  },
  {
    "objectID": "lecture_11_survival_summary.html#most-important-things",
    "href": "lecture_11_survival_summary.html#most-important-things",
    "title": "Survival analysis and Summary",
    "section": "Most important things",
    "text": "Most important things\n\nDesigning an experiment\nR tips and tricks\nEntering data into a spreadsheet\nImporting data\nCleaning data\nData visualisation\nUsing R markdown\nChoosing a model type\nInterpreting model output"
  },
  {
    "objectID": "lecture_11_survival_summary.html#designing-an-experiment",
    "href": "lecture_11_survival_summary.html#designing-an-experiment",
    "title": "Survival analysis and Summary",
    "section": "Designing an experiment",
    "text": "Designing an experiment"
  },
  {
    "objectID": "lecture_11_survival_summary.html#r-tips-and-tricks",
    "href": "lecture_11_survival_summary.html#r-tips-and-tricks",
    "title": "Survival analysis and Summary",
    "section": "R tips and tricks",
    "text": "R tips and tricks"
  },
  {
    "objectID": "lecture_11_survival_summary.html#entering-data-into-a-spreadsheet",
    "href": "lecture_11_survival_summary.html#entering-data-into-a-spreadsheet",
    "title": "Survival analysis and Summary",
    "section": "Entering data into a spreadsheet",
    "text": "Entering data into a spreadsheet"
  },
  {
    "objectID": "lecture_11_survival_summary.html#importing-data",
    "href": "lecture_11_survival_summary.html#importing-data",
    "title": "Survival analysis and Summary",
    "section": "Importing data",
    "text": "Importing data"
  },
  {
    "objectID": "lecture_11_survival_summary.html#cleaning-data",
    "href": "lecture_11_survival_summary.html#cleaning-data",
    "title": "Survival analysis and Summary",
    "section": "Cleaning data",
    "text": "Cleaning data"
  },
  {
    "objectID": "lecture_11_survival_summary.html#data-visualisation",
    "href": "lecture_11_survival_summary.html#data-visualisation",
    "title": "Survival analysis and Summary",
    "section": "Data visualisation",
    "text": "Data visualisation"
  },
  {
    "objectID": "lecture_11_survival_summary.html#using-quarto",
    "href": "lecture_11_survival_summary.html#using-quarto",
    "title": "Survival analysis and Summary",
    "section": "Using quarto",
    "text": "Using quarto"
  },
  {
    "objectID": "lecture_11_survival_summary.html#choosing-a-model",
    "href": "lecture_11_survival_summary.html#choosing-a-model",
    "title": "Survival analysis and Summary",
    "section": "Choosing a model",
    "text": "Choosing a model"
  },
  {
    "objectID": "lecture_11_survival_summary.html#interpreting-model-output",
    "href": "lecture_11_survival_summary.html#interpreting-model-output",
    "title": "Survival analysis and Summary",
    "section": "Interpreting model output",
    "text": "Interpreting model output"
  },
  {
    "objectID": "lecture_11_survival_summary.html#method-choice---2-key-questions",
    "href": "lecture_11_survival_summary.html#method-choice---2-key-questions",
    "title": "Survival analysis and Summary",
    "section": "Method choice - 2 key questions",
    "text": "Method choice - 2 key questions\nAre the data clustered/grouped?\nWhat is the distribution of the residuals?\n(also other types of model - survival etc)"
  },
  {
    "objectID": "lecture_11_survival_summary.html#clustered-data",
    "href": "lecture_11_survival_summary.html#clustered-data",
    "title": "Survival analysis and Summary",
    "section": "Clustered data",
    "text": "Clustered data\nMixed effect models\n\nNormal distribution: linear mixed effect models\nBinomial/poisson: generalised linear mixed effect models"
  },
  {
    "objectID": "lecture_11_survival_summary.html#independent-data-normal-distribution",
    "href": "lecture_11_survival_summary.html#independent-data-normal-distribution",
    "title": "Survival analysis and Summary",
    "section": "Independent data, normal distribution",
    "text": "Independent data, normal distribution\nLinear models - ordinary least squares\n\nt-tests\ntwo sample t-test\none sample t-test\npaired t-test\nlm"
  },
  {
    "objectID": "lecture_11_survival_summary.html#independent-data-non-normal-distribution",
    "href": "lecture_11_survival_summary.html#independent-data-non-normal-distribution",
    "title": "Survival analysis and Summary",
    "section": "Independent data, non-normal distribution",
    "text": "Independent data, non-normal distribution\ngeneralised linear models\n\nglm\n\nBinomial & Poisson distributions"
  },
  {
    "objectID": "lecture_11_survival_summary.html#interpreting-model-output-1",
    "href": "lecture_11_survival_summary.html#interpreting-model-output-1",
    "title": "Survival analysis and Summary",
    "section": "Interpreting model output",
    "text": "Interpreting model output\n\ndata(penguins, package = \"palmerpenguins\")\nmod &lt;- lm(bill_length_mm ~ sex * species, data = penguins)\nsummary(mod)\n\n\nCall:\nlm(formula = bill_length_mm ~ sex * species, data = penguins)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.7904 -1.3735 -0.0638  1.2096 11.4265 \n\nCoefficients:\n                         Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)               37.2575     0.2710 137.473  &lt; 2e-16 ***\nsexmale                    3.1329     0.3833   8.174 6.64e-15 ***\nspeciesChinstrap           9.3160     0.4808  19.377  &lt; 2e-16 ***\nspeciesGentoo              8.3063     0.4073  20.393  &lt; 2e-16 ***\nsexmale:speciesChinstrap   1.3877     0.6799   2.041   0.0421 *  \nsexmale:speciesGentoo      0.7771     0.5721   1.358   0.1753    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.316 on 327 degrees of freedom\n  (11 observations deleted due to missingness)\nMultiple R-squared:  0.8234,    Adjusted R-squared:  0.8207 \nF-statistic:   305 on 5 and 327 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "lecture_11_survival_summary.html#more-statistics-at-bio",
    "href": "lecture_11_survival_summary.html#more-statistics-at-bio",
    "title": "Survival analysis and Summary",
    "section": "More statistics at BIO",
    "text": "More statistics at BIO\nBio302 - more regression methods\nBio303 - multivatiate methods"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#assumptions-of-least-squares",
    "href": "lecture_9_generalised_linear_models.html#assumptions-of-least-squares",
    "title": "Generalised Linear Models",
    "section": "Assumptions of Least Squares",
    "text": "Assumptions of Least Squares\n\nLinear relationship between response and predictors.\nThe residuals have a mean of zero.\nThe residuals have constant variance (not heteroscedastic).\nThe residuals are independent (uncorrelated).\nThe residuals are normally distributed."
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#generalised-linear-models",
    "href": "lecture_9_generalised_linear_models.html#generalised-linear-models",
    "title": "Generalised Linear Models",
    "section": "Generalised linear models",
    "text": "Generalised linear models\n\nAllow non-normal residual distributions\n\nPoisson\nBinomial\nGamma\netc\n\nCoefficients found with maximum likelihood"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#least-squares",
    "href": "lecture_9_generalised_linear_models.html#least-squares",
    "title": "Generalised Linear Models",
    "section": "Least squares",
    "text": "Least squares\nChoose \\(\\beta\\) that minimise the sum of squares of residuals\n\\[\\sum_{i = 1}^{n}\\epsilon_i^2 =   \\sum_{i = 1}^{n}(y_i - (\\beta_0 + \\beta_1x_i))^2\\]\n\n\n\n\n\n\n\n\nAssumes residuals have normal distribution"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#likelihood",
    "href": "lecture_9_generalised_linear_models.html#likelihood",
    "title": "Generalised Linear Models",
    "section": "Likelihood",
    "text": "Likelihood\nHow likely is the model given the data?\n\nchoose coefficients to maximise likelihood\nworks with any distribution"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#likelihood-with-a-normal-distribution",
    "href": "lecture_9_generalised_linear_models.html#likelihood-with-a-normal-distribution",
    "title": "Generalised Linear Models",
    "section": "Likelihood with a normal distribution:",
    "text": "Likelihood with a normal distribution:\n\\[\\mathcal{L}(\\mu,\\sigma|y) = \\frac{1}{\\sigma \\sqrt {2\\pi } }e^{-\\frac{(x - \\mu)^2} {{2\\sigma ^2 }}}\\]"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#maximum-likelihood-of-the-model",
    "href": "lecture_9_generalised_linear_models.html#maximum-likelihood-of-the-model",
    "title": "Generalised Linear Models",
    "section": "Maximum Likelihood of the model",
    "text": "Maximum Likelihood of the model\nFind likelihood for each observation & combine them\n\n\nProduct of likelihoods fails\n\n\\[\\prod_{i =1}^n\\mathcal{L}(\\mu,\\sigma|y) \\approx0\\]\n\n\n\n\nUse log-likelihood\n\n\\[\\mathcal{l}(\\mu,\\sigma|y) = log(\\mathcal{L}(\\mu,\\sigma|y))\\]\n\n\nFind the sum of the log-likelihoods\n\\[\\sum_{i = 1}^n{(\\mathcal{l}(\\mu,\\sigma|y))} = {log}(\\prod_{i = 1}^n{\\mathcal{L}(\\mu,\\sigma|y)})\\]\nChoose coefficients that give maximum log-likelihood"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#using-maximum-likelihood-in-r",
    "href": "lecture_9_generalised_linear_models.html#using-maximum-likelihood-in-r",
    "title": "Generalised Linear Models",
    "section": "Using maximum likelihood in R",
    "text": "Using maximum likelihood in R\n\ngentoo &lt;- penguins |&gt; filter(species == \"Adelie\") |&gt; drop_na(bill_length_mm)\nmod_ls &lt;- lm(bill_length_mm ~ island, data = gentoo)\nmod_ml &lt;- glm(bill_length_mm ~ island, data = gentoo)\n\nmod_ls |&gt; broom::tidy()\n\n# A tibble: 3 × 5\n  term            estimate std.error statistic   p.value\n  &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)      39.0        0.403   96.8    1.08e-135\n2 islandDream      -0.473      0.538   -0.879  3.81e-  1\n3 islandTorgersen  -0.0240     0.550   -0.0437 9.65e-  1\n\nmod_ml |&gt; broom::tidy()\n\n# A tibble: 3 × 5\n  term            estimate std.error statistic   p.value\n  &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)      39.0        0.403   96.8    1.08e-135\n2 islandDream      -0.473      0.538   -0.879  3.81e-  1\n3 islandTorgersen  -0.0240     0.550   -0.0437 9.65e-  1"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#deviance",
    "href": "lecture_9_generalised_linear_models.html#deviance",
    "title": "Generalised Linear Models",
    "section": "Deviance",
    "text": "Deviance\nAnalogous to Sum of Squares in a linear model\nSmaller residual deviance is better\n\n\\(\\mathcal{L}_M\\) maximum likelihood\n\\(\\mathcal{L}_S\\) likelihood of saturated model\n\n\\[deviance = -2(log(\\mathcal{L}_M) - log(\\mathcal{L}_S))\\]"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#generalised-linear-models-1",
    "href": "lecture_9_generalised_linear_models.html#generalised-linear-models-1",
    "title": "Generalised Linear Models",
    "section": "Generalised linear models",
    "text": "Generalised linear models\nLink function and Linear predictor\n\\[\\color{red}{{g(E(\\mu_i))}} = \\color{blue}{ \\beta_0 + \\beta_1x_i}\\] - Link function transforms the expected value\nVariance function\n\\[\\color{purple}{var(Y_i) = \\phi V(\\mu_i)}\\]\n\ndescribes how the variance depends on the mean; dispersion parameter \\(\\phi\\) is a constant"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#normal-gaussian",
    "href": "lecture_9_generalised_linear_models.html#normal-gaussian",
    "title": "Generalised Linear Models",
    "section": "Normal (Gaussian)",
    "text": "Normal (Gaussian)\n\ny continuous\nAll values \\(-\\infty +\\infty\\)\n\\(\\color{red}{\\mu} = \\color{red}{E(y_i)} = \\color{blue}{β_0 + β_1x_i}\\)\n\\(\\color{purple}{var(y)} = \\color{purple}{σ^2}\\)"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#poisson",
    "href": "lecture_9_generalised_linear_models.html#poisson",
    "title": "Generalised Linear Models",
    "section": "Poisson",
    "text": "Poisson\n\n\n\nDiscrete\nCounts\n\\(\\color{red}{log(\\mu)} = \\color{blue}{β_0 + β_1x_i}\\)\n\\(\\color{purple}{var(y)} = \\color{purple}{\\mu}\\)"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#poisson-example",
    "href": "lecture_9_generalised_linear_models.html#poisson-example",
    "title": "Generalised Linear Models",
    "section": "Poisson example",
    "text": "Poisson example\nSpecies richness on Mt Gonga grasslands\n\n\n\n\n\n\n\n\n\n\nsite\nelevation\nrichness\n\n\n\n\nH\n4100\n23\n\n\nH\n4100\n19\n\n\nA\n3850\n15\n\n\nA\n3850\n21\n\n\nM\n3500\n25\n\n\nM\n3500\n25\n\n\nL\n3000\n10\n\n\nL\n3000\n14"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#predictions",
    "href": "lecture_9_generalised_linear_models.html#predictions",
    "title": "Generalised Linear Models",
    "section": "Predictions",
    "text": "Predictions\nPredictions by default on the linear predictor scale\n\nnd &lt;- tibble(elevation = seq(3000, 4100, by = 100))\npredict(mod_g, newdata = nd)\n\n       1        2        3        4        5        6        7        8 \n2.715362 2.748475 2.781588 2.814700 2.847813 2.880926 2.914039 2.947152 \n       9       10       11       12 \n2.980265 3.013378 3.046490 3.079603 \n\n\nCan predict on response scale with type argument\n\npredict(mod_g, newdata = nd, type = \"response\")\n\n       1        2        3        4        5        6        7        8 \n15.11008 15.61879 16.14463 16.68818 17.25002 17.83078 18.43109 19.05162 \n       9       10       11       12 \n19.69303 20.35604 21.04137 21.74977 \n\n\nOr use inverse of Link function - exp() for Poisson"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#predictions-with-uncertainty",
    "href": "lecture_9_generalised_linear_models.html#predictions-with-uncertainty",
    "title": "Generalised Linear Models",
    "section": "Predictions with uncertainty",
    "text": "Predictions with uncertainty\nNeed to do calculations on link scale\n\naugment(mod_g, newdata = nd, se_fit = TRUE, type.predict = \"link\")\n\n# A tibble: 12 × 3\n   elevation .fitted .se.fit\n       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n 1      3000    2.72  0.0509\n 2      3100    2.75  0.0452\n 3      3200    2.78  0.0398\n 4      3300    2.81  0.0351\n 5      3400    2.85  0.0312\n 6      3500    2.88  0.0285\n 7      3600    2.91  0.0273\n 8      3700    2.95  0.0279\n 9      3800    2.98  0.0301\n10      3900    3.01  0.0336\n11      4000    3.05  0.0380\n12      4100    3.08  0.0432"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#binomial",
    "href": "lecture_9_generalised_linear_models.html#binomial",
    "title": "Generalised Linear Models",
    "section": "Binomial",
    "text": "Binomial\n\n\n\nSuccess/failure,\none or many trials\n\\(\\color{red}{log(\\frac{\\mu}{1 - \\mu})} = \\color{blue}{β_0 + β_1x_i}\\)\n\\(\\color{purple}{var(y)} = \\color{purple}{n\\mu(1 - μ)}\\)"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#binomial-example",
    "href": "lecture_9_generalised_linear_models.html#binomial-example",
    "title": "Generalised Linear Models",
    "section": "Binomial example",
    "text": "Binomial example\nPresence/absence of Tabellaria binalis in European lakes along a pH gradient\n\ndata(SWAP, package= \"rioja\")\nswap_data &lt;- bind_cols(pH = SWAP$pH, SWAP$spec) |&gt; \n  mutate(TA003A = sign(TA003A)) |&gt; \n  select(pH, TA003A)\n\nswap_data\n\n            pH TA003A\n1.21     4.491      1\n10.21    5.264      0\n11       4.900      1\n113.21   6.431      0\n115.11   5.682      0\n12.11    5.244      1\n121      4.800      1\n15.11    5.407      1\n17.21    4.912      0\n18.11    5.441      0\n181      6.300      0\n19.21    6.256      0\n2.11     4.966      1\n20.11    6.577      0\n21       4.500      1\n21.11    6.046      0\n3.11     4.600      1\n3.511    7.000      0\n34.11    5.040      0\n37.11    6.494      0\n4.11     4.381      1\n42.11    5.095      1\n44.21    6.600      0\n49.11    4.792      1\n5.11     4.640      1\n59.11    5.517      0\n6.21     4.616      1\n601      4.800      1\n61       4.600      1\n65.21    6.175      0\n66.11    5.990      0\n71       5.700      0\n8.21     4.930      1\n80.11    4.730      1\n81.21    4.522      1\n82.11    4.619      1\n83.11    4.945      0\n86.11    4.890      1\n87.21    5.141      1\n88.21    5.260      0\n89.11    5.766      0\n9.11     4.676      1\nACH1     5.101      0\nARR1     6.179      0\nARTH1    7.093      0\nBARE1    6.748      0\nBARL1    6.430      0\nBER1     4.330      0\nBODG1    6.530      0\nBODL1    5.380      0\nBREC1    6.596      0\nBUGE1    4.840      0\nBURNMT1  6.400      0\nBYCH1    6.440      0\nCFYN1    5.470      0\nCHN1     5.144      1\nCLON1    6.942      0\nCLYD1    6.140      0\nCON1     4.820      0\nCOR1     5.328      1\nCWBY1    5.150      1\nDEVOKE1  6.100      0\nDIWA1    5.720      0\nDOI1     5.899      1\nDOON1    5.237      0\nDUH1     5.134      1\nDUL1     5.160      0\nENO1     4.543      1\nEUN1     4.952      0\nFHI1     5.283      1\nFINL1    5.756      0\nFLE1     4.538      1\nGARN1    6.250      0\nGEIR1    6.760      0\nGLAS1    6.240      0\nGLYN1    4.920      0\nGOD1     5.660      0\nGREENT1  5.200      0\nGULSPET1 4.830      1\nGWYN1    6.690      0\nGYN1     5.120      0\nHARR1    5.019      0\nHIR1     4.760      0\nHOLET1   4.500      1\nHOLMEV1  4.700      1\nINVA1    6.586      0\nIRD1     5.260      0\nKIRR1    5.116      0\nLAG1     5.240      0\nLAI1     5.400      0\nLAR1     4.875      1\nLCSL1    5.180      0\nLCSU1    5.350      0\nLDE1     5.288      0\nLDE2     5.700      0\nLENY1    6.240      0\nLGR1     4.643      1\nLGR2     4.800      1\nLJOSV1   4.410      1\nLLDU1    5.800      0\nLLGH1    4.642      1\nLOD1     5.547      1\nLOWT1    5.000      1\nMABE1    5.265      0\nMACA1    5.022      1\nMANN1    6.445      0\nMINN1    5.166      0\nMUCK1    5.417      0\nNAGA1    5.038      0\nOCHI1    5.953      0\nPARC1    6.800      0\nPENR1    5.040      0\nRIEC1    5.266      0\nRLGH1    4.718      1\nRLGH2    4.800      1\nRONA1    6.532      0\nS101     6.650      0\nS11      6.840      0\nS111     5.250      1\nS121     6.510      0\nS131     5.220      0\nS141     6.380      0\nS151     7.250      0\nS161     6.400      0\nS171     5.810      0\nS181     5.840      0\nS191     5.030      0\nS201     5.490      1\nS21      7.160      0\nS211     4.500      1\nS221     4.410      1\nS241     5.990      0\nS251     6.970      0\nS261     6.580      0\nS271     5.130      1\nS281     4.940      1\nS291     5.010      1\nS301     5.520      0\nS31      6.650      0\nS311     5.890      1\nS41      5.750      1\nS61      5.970      0\nS71      6.460      1\nS81      6.700      1\nS91      6.200      0\nSCOATT1  5.000      1\nSKAK1    5.846      0\nSKE1     5.125      0\nSKE2     5.100      0\nSKOMAKV1 4.670      1\nSTRO1    4.837      0\nTANN1    4.995      1\nTEAN1    5.700      0\nTECW1    6.060      0\nTINK1    5.966      0\nTROO1    5.030      1\nUAI1     5.767      0\nUIS1     6.209      0\nURR1     6.770      0\nVAL1     4.688      1\nVEREV1   4.490      1\nWHIN1    6.899      0\nWHIN2    6.900      0\nWHIT1    7.031      0\nWOOD1    6.782      0\nWOOD2    6.900      0\nYGAD1    5.740      0"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#tabellaria-binalis-against-ph",
    "href": "lecture_9_generalised_linear_models.html#tabellaria-binalis-against-ph",
    "title": "Generalised Linear Models",
    "section": "Tabellaria binalis against pH",
    "text": "Tabellaria binalis against pH\n\nggplot(swap_data, aes(x = pH, y = TA003A)) +\n  geom_jitter(height = 0.1, width = 0, alpha = 0.5)"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#log-odds---logit",
    "href": "lecture_9_generalised_linear_models.html#log-odds---logit",
    "title": "Generalised Linear Models",
    "section": "log odds - logit",
    "text": "log odds - logit"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#fitting-the-model",
    "href": "lecture_9_generalised_linear_models.html#fitting-the-model",
    "title": "Generalised Linear Models",
    "section": "Fitting the model",
    "text": "Fitting the model\n\nmod_swap &lt;- glm(TA003A ~ pH, data = swap_data, family = binomial)\nsummary(mod_swap)\n\n\nCall:\nglm(formula = TA003A ~ pH, family = binomial, data = swap_data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.1241  -0.6212  -0.1951   0.7070   2.9322  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  13.8942     2.3506   5.911 3.40e-09 ***\npH           -2.7134     0.4531  -5.988 2.13e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 218.10  on 166  degrees of freedom\nResidual deviance: 144.24  on 165  degrees of freedom\nAIC: 148.24\n\nNumber of Fisher Scoring iterations: 6"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#predictions-1",
    "href": "lecture_9_generalised_linear_models.html#predictions-1",
    "title": "Generalised Linear Models",
    "section": "Predictions",
    "text": "Predictions\n\npreds_swap &lt;- augment(mod_swap, type.predict = \"link\", se_fit = TRUE) |&gt; \n  mutate(\n    fitted = plogis(.fitted), \n    lower = plogis(.fitted + .se.fit * 1.96),\n    upper = plogis(.fitted - .se.fit * 1.96),\n  )\npreds_swap\n\n# A tibble: 167 × 13\n   .rownames TA003A    pH .fitted .se.fit .resid .std.resid    .hat .sigma\n   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;\n 1 1.21           1  4.49   1.71    0.369  0.577      0.582 0.0177   0.937\n 2 10.21          0  5.26  -0.389   0.210 -1.02      -1.02  0.0106   0.934\n 3 11             1  4.9    0.599   0.238  0.936      0.942 0.0130   0.935\n 4 113.21         0  6.43  -3.56    0.608 -0.237     -0.239 0.00999  0.938\n 5 115.11         0  5.68  -1.52    0.310 -0.628     -0.633 0.0142   0.937\n 6 12.11          1  5.24  -0.335   0.208  1.32       1.33  0.0105   0.932\n 7 121            1  4.8    0.870   0.264  0.837      0.843 0.0145   0.936\n 8 15.11          1  5.41  -0.777   0.232  1.52       1.53  0.0116   0.930\n 9 17.21          0  4.91   0.566   0.235 -1.43      -1.43  0.0128   0.931\n10 18.11          0  5.44  -0.869   0.240 -0.837     -0.842 0.0119   0.936\n# … with 157 more rows, and 4 more variables: .cooksd &lt;dbl&gt;, fitted &lt;dbl&gt;,\n#   lower &lt;dbl&gt;, upper &lt;dbl&gt;"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#binomial-with-multiple-trials",
    "href": "lecture_9_generalised_linear_models.html#binomial-with-multiple-trials",
    "title": "Generalised Linear Models",
    "section": "Binomial with multiple trials",
    "text": "Binomial with multiple trials\nTobacco budworm vs pesticide dose\n\n## example from Venables and Ripley (2002, pp. 190-2.)\nbudworm &lt;- tibble(\n  ldose = rep(0:5, 2), #log dose\n  n = 20,\n  numdead = c(1, 4, 9, 13, 18, 20, 0, 2, 6, 10, 12, 16),\n  propdead = numdead/n,\n  sex = factor(rep(c(\"M\", \"F\"), c(6, 6)))\n  )\n\nbudworm\n\n# A tibble: 12 × 5\n   ldose     n numdead propdead sex  \n   &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;\n 1     0    20       1     0.05 M    \n 2     1    20       4     0.2  M    \n 3     2    20       9     0.45 M    \n 4     3    20      13     0.65 M    \n 5     4    20      18     0.9  M    \n 6     5    20      20     1    M    \n 7     0    20       0     0    F    \n 8     1    20       2     0.1  F    \n 9     2    20       6     0.3  F    \n10     3    20      10     0.5  F    \n11     4    20      12     0.6  F    \n12     5    20      16     0.8  F"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#choice-of-family-for-glm",
    "href": "lecture_9_generalised_linear_models.html#choice-of-family-for-glm",
    "title": "Generalised Linear Models",
    "section": "Choice of family for GLM",
    "text": "Choice of family for GLM\n\neggshell thickness in mm\nnumber of eggs in nest\noccurrence of nest predation\nproportion of eggs that hatch\ntime to hatch in days"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#underdispersion-and-overdispersion",
    "href": "lecture_9_generalised_linear_models.html#underdispersion-and-overdispersion",
    "title": "Generalised Linear Models",
    "section": "Underdispersion and overdispersion",
    "text": "Underdispersion and overdispersion\nFixed relationship between mean and variance\n\nPoisson: \\(\\color{purple}{var(y) = \\mu}\\)\nBinomial: \\(\\color{purple}{var(y) = n\\mu(1 - μ)}\\)\n\nModels can have less/more dispersion than expected\n\nPoisson\nBinomial when n trials &gt; 1\n\nOverdispersion increases risk of type I error\n\nrejection of \\(H_0\\) when it is true\nfalse positive"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#checking-for-overdispersion",
    "href": "lecture_9_generalised_linear_models.html#checking-for-overdispersion",
    "title": "Generalised Linear Models",
    "section": "Checking for overdispersion",
    "text": "Checking for overdispersion\n\nanova(mod_g)\n\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: richness\n\nTerms added sequentially (first to last)\n\n          Df Deviance Resid. Df Resid. Dev\nNULL                         72     62.198\nelevation  1   23.156        71     39.042\n\n\nIf residual deviance / residual df \\(\\approx\\) 1 then OK\nIf not, then model under or over dispersed"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#mt-gonga-cf-poisson-distribution",
    "href": "lecture_9_generalised_linear_models.html#mt-gonga-cf-poisson-distribution",
    "title": "Generalised Linear Models",
    "section": "Mt Gonga cf Poisson distribution",
    "text": "Mt Gonga cf Poisson distribution"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#fixes-for-overdispersion",
    "href": "lecture_9_generalised_linear_models.html#fixes-for-overdispersion",
    "title": "Generalised Linear Models",
    "section": "Fixes for overdispersion",
    "text": "Fixes for overdispersion\n\nInclude relevant missing predictors in model\nUse quasilikelihood models\n\n\n\n\npoission -&gt; quasipoisson\n\n\n\nbinomial -&gt; quasibinomial\n\n\n\nAdds scale parameter to variance function \\(\\color{purple}{var(Y) = \\phi \\mu}\\)\n\nChoose another distribution\n\n\n\n\nnegative binomial\n\n\n\nbeta-binomial"
  },
  {
    "objectID": "lecture_9_generalised_linear_models.html#quasipoisson",
    "href": "lecture_9_generalised_linear_models.html#quasipoisson",
    "title": "Generalised Linear Models",
    "section": "Quasipoisson",
    "text": "Quasipoisson\nSame coefficients, but tests adjusted\n\nmod_q &lt;- glm(richness ~ elevation, data = gonga_rich,\n             family = quasipoisson)\nanova(mod_q, test = \"F\")"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#bivariate-descriptive-statistics",
    "href": "lecture_7_linear_regression1.html#bivariate-descriptive-statistics",
    "title": "Linear Regression 1",
    "section": "Bivariate descriptive statistics",
    "text": "Bivariate descriptive statistics\n\n\nMeasures of association\n\ncovariance\ncorrelation\n\n\nUse with\n\ntwo continuous variables\npaired data\nunclear direction of causality"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#covariance",
    "href": "lecture_7_linear_regression1.html#covariance",
    "title": "Linear Regression 1",
    "section": "Covariance",
    "text": "Covariance\n\n\nAssociation between two variables\n\\(S_{xy} = \\frac{\\Sigma (x_i - \\mu_x)(y_i - \\mu_y)}{n - 1}\\)\n\\(S_{xy} = S_{yx}\\)\n\n-inf, 0, +inf\n+ = positive association\n- = negative association\ncov()"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#correlation",
    "href": "lecture_7_linear_regression1.html#correlation",
    "title": "Linear Regression 1",
    "section": "Correlation",
    "text": "Correlation\n\n\nPearson coefficient of correlation\nStandardised association\n\n\\(S_{xy}\\) - covariance of x & y\n\\(S_x^2\\) - variance of x\n\\(S_y^2\\) - variance of y\n\n\\(r_{xy} = \\frac{S_{xy}}{\\sqrt{S_x^2S_y^2}}\\)\n\\(r_{xy} = r_{yx}\\)\n\n\n-1, 0, +1\n+ = positive association\n- = negative association"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#correlations-in-r",
    "href": "lecture_7_linear_regression1.html#correlations-in-r",
    "title": "Linear Regression 1",
    "section": "Correlations in R",
    "text": "Correlations in R\n\ncor(x = penguins$bill_length_mm,\n    y = penguins$body_mass_g, \n    use = \"pairwise.complete\")\n\n[1] 0.5951\n\n\n\npenguins |&gt; \n  select(bill_length_mm:body_mass_g) |&gt; \ncor(use = \"complete.obs\")\n\n                  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\nbill_length_mm            1.0000       -0.2351            0.6562      0.5951\nbill_depth_mm            -0.2351        1.0000           -0.5839     -0.4719\nflipper_length_mm         0.6562       -0.5839            1.0000      0.8712\nbody_mass_g               0.5951       -0.4719            0.8712      1.0000"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#r2",
    "href": "lecture_7_linear_regression1.html#r2",
    "title": "Linear Regression 1",
    "section": "\\(R^2\\)",
    "text": "\\(R^2\\)\nCoefficient of determination\n\\[R^2 = r^2\\]\n\n0 - 1\nproportion of variance explained\n\\(R^2\\) = 0.5, 50% of variation in data explained"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#testing-a-correlation",
    "href": "lecture_7_linear_regression1.html#testing-a-correlation",
    "title": "Linear Regression 1",
    "section": "Testing a Correlation",
    "text": "Testing a Correlation\n\ncor.test(penguins$bill_length_mm,\n    penguins$body_mass_g, \n    use = \"pairwise.complete\")\n\n\n    Pearson's product-moment correlation\n\ndata:  penguins$bill_length_mm and penguins$body_mass_g\nt = 14, df = 340, p-value &lt;2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.5220 0.6595\nsample estimates:\n   cor \n0.5951 \n\n\nNot robust to outliers\n\nNon-parametric correlation (Spearman Rank, Kendall Tau)\nBootstrap estimation of confidence interval"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#least-squares-regression",
    "href": "lecture_7_linear_regression1.html#least-squares-regression",
    "title": "Linear Regression 1",
    "section": "Least squares regression",
    "text": "Least squares regression\nDescribe relationship between response y and predictor x \\[y = β_0 + β_1x\\]\n\n\n\nEstimate model coefficients with uncertainty\nTest if terms in the model are significant\nCheck the method’s assumptions\nView the model diagnostics\nMake predictions with confidence intervals"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#we-want-the-parameters-beta",
    "href": "lecture_7_linear_regression1.html#we-want-the-parameters-beta",
    "title": "Linear Regression 1",
    "section": "We want the parameters \\(\\beta\\)",
    "text": "We want the parameters \\(\\beta\\)\n\\[y_i = \\beta_0 + \\beta_1x_i + \\epsilon_i  \\]\n\n\\(y\\) = continuous response\n\\(x\\) = continuous or categorical predictor\n\\(i = 1, ..., n\\) observations - \\((xi, yi)\\) observation pairs\n\\(ε_i\\) = residual at \\(i\\)\n\\(β_0\\) = mean, intercept\n\\(β_1\\) = effect, slope\n\nResiduals are actual - predicted"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#criteria",
    "href": "lecture_7_linear_regression1.html#criteria",
    "title": "Linear Regression 1",
    "section": "Criteria",
    "text": "Criteria\n\n\\(\\epsilon \\sim N(0, \\sigma)\\)\n\\(y \\sim N(\\mu, \\sigma)\\)\n\nUse when\n\nResponse variable is continuous\nPredictor variable(s) are continuous or categorical\nObservations are independent\nOther assumptions are met\nDirection of causality is clear\nWant to make predictions\nWant effect size as slope or differences between groups"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#correlation-or-linear-model",
    "href": "lecture_7_linear_regression1.html#correlation-or-linear-model",
    "title": "Linear Regression 1",
    "section": "Correlation or linear model?",
    "text": "Correlation or linear model?\nStudying foram test composition and temperature\n\nExperiment with forams in tanks at different temperatures.\n\n\ntest Mg concentration, tank temperature\ntest Mg concentration, test Ba concentration\n\n\nObservational study of forams collected from the ocean.\n\n\ntest Mg concentration, Ocean temperature\nOcean temperature, ocean Mg concentration\ntest Mg concentration, foram species"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#estimating-beta",
    "href": "lecture_7_linear_regression1.html#estimating-beta",
    "title": "Linear Regression 1",
    "section": "Estimating \\(\\beta\\)",
    "text": "Estimating \\(\\beta\\)\n\n\nChoose \\(\\beta\\) that minimise the sum of squares of residuals\n\\[\\sum_{i = 1}^{n}\\epsilon_i^2 =   \\sum_{i = 1}^{n}(y_i - (\\beta_0 + \\beta_1x_i))^2\\]"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#calculating-beta",
    "href": "lecture_7_linear_regression1.html#calculating-beta",
    "title": "Linear Regression 1",
    "section": "Calculating \\(\\beta\\)",
    "text": "Calculating \\(\\beta\\)\n\\[\\beta_1 = \\frac{s_{xy}}{s_x^2}\\] Covariance of xy / variance of x\n\\[\\beta_0 = mean(y) - \\beta_1 mean(x)\\]"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#fitting-a-least-squares-model-in-r",
    "href": "lecture_7_linear_regression1.html#fitting-a-least-squares-model-in-r",
    "title": "Linear Regression 1",
    "section": "Fitting a least-squares model in R",
    "text": "Fitting a least-squares model in R\n\ngentoo &lt;- penguins |&gt; filter(species == \"Gentoo\")\n\nmod &lt;- lm(bill_length_mm ~ body_mass_g, data = gentoo)\nmod\n\n\nCall:\nlm(formula = bill_length_mm ~ body_mass_g, data = gentoo)\n\nCoefficients:\n(Intercept)  body_mass_g  \n   26.73955      0.00409"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#summary",
    "href": "lecture_7_linear_regression1.html#summary",
    "title": "Linear Regression 1",
    "section": "Summary()",
    "text": "Summary()\n\nsummary(mod)\n\n\nCall:\nlm(formula = bill_length_mm ~ body_mass_g, data = gentoo)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-5.880 -1.508 -0.058  1.312  8.111 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 2.67e+01   2.11e+00   12.69   &lt;2e-16 ***\nbody_mass_g 4.09e-03   4.13e-04    9.91   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.3 on 121 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.448, Adjusted R-squared:  0.443 \nF-statistic: 98.1 on 1 and 121 DF,  p-value: &lt;2e-16"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#variance-partitioning",
    "href": "lecture_7_linear_regression1.html#variance-partitioning",
    "title": "Linear Regression 1",
    "section": "Variance partitioning",
    "text": "Variance partitioning\n\n\nTotal sum of squares \\(SS_{total}\\)\nSquared differences of observation from mean\nResidual sum of squares \\(SS_{residual}\\)\nSquared differences of observation from regression line\nRegression sum of squares \\(SS_{regression}\\)\nSquared differences of regression line from mean"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#r2-1",
    "href": "lecture_7_linear_regression1.html#r2-1",
    "title": "Linear Regression 1",
    "section": "\\(R^2\\)",
    "text": "\\(R^2\\)\nCoefficient of determination\nCoefficient of multiple correlation\n\\[R^2 = 1 - \\frac{\\color{green}{SS_{residual}}}{\\color{red}{SS_{total}}}\\]\n\n0 - 1\n\\(R^2\\) = 0.5 – 50% of variation in data explained\nAlways increases with more predictors"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#adjusted-r2",
    "href": "lecture_7_linear_regression1.html#adjusted-r2",
    "title": "Linear Regression 1",
    "section": "Adjusted \\(R^2\\)",
    "text": "Adjusted \\(R^2\\)\nCorrects for number of parameters\n\\[\nR^2_{adj} = 1 - \\frac{(1-R^2)(n-1)}{n-p-1}\n\\] \\(R^2\\) = R squared\n\\(n\\) = number of observations\n\\(p\\) = number of parameters\nOnly increases if useful predictors added\nCan be negative"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#anova",
    "href": "lecture_7_linear_regression1.html#anova",
    "title": "Linear Regression 1",
    "section": "Anova",
    "text": "Anova\n\\[F = \\frac{\\color{blue}{SS_{regression}}/df_{regression}}{\\color{green}{SS_{residual}}/df_{residual}}\\]\n\ncar::Anova(mod)\n\nAnova Table (Type II tests)\n\nResponse: bill_length_mm\n            Sum Sq  Df F value Pr(&gt;F)    \nbody_mass_g    519   1    98.1 &lt;2e-16 ***\nResiduals      640 121                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#the-f-distribution",
    "href": "lecture_7_linear_regression1.html#the-f-distribution",
    "title": "Linear Regression 1",
    "section": "The F distribution",
    "text": "The F distribution"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#categorical-predictors",
    "href": "lecture_7_linear_regression1.html#categorical-predictors",
    "title": "Linear Regression 1",
    "section": "Categorical predictors",
    "text": "Categorical predictors\n\n\nDoes penguin body mass depend on species?\nPredictor = species (categorical)\nResponse = body mass (continuous)\nHypotheses\n\\[H_0: \\mu_{Adelie} = \\mu_{Chinstrap} = \\mu_{Gentoo}\\] \\(H_A\\) At least two of the means differ"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#fitting-the-model",
    "href": "lecture_7_linear_regression1.html#fitting-the-model",
    "title": "Linear Regression 1",
    "section": "Fitting the model",
    "text": "Fitting the model\n\nmod2 &lt;- lm(body_mass_g ~ species, data = penguins)\nmod2\n\n\nCall:\nlm(formula = body_mass_g ~ species, data = penguins)\n\nCoefficients:\n     (Intercept)  speciesChinstrap     speciesGentoo  \n          3700.7              32.4            1375.4"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#anova-1",
    "href": "lecture_7_linear_regression1.html#anova-1",
    "title": "Linear Regression 1",
    "section": "Anova",
    "text": "Anova\n\ncar::Anova(mod2)\n\nAnova Table (Type II tests)\n\nResponse: body_mass_g\n            Sum Sq  Df F value Pr(&gt;F)    \nspecies   1.47e+08   2     344 &lt;2e-16 ***\nResiduals 7.24e+07 339                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAt least two groups differ"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#summary-1",
    "href": "lecture_7_linear_regression1.html#summary-1",
    "title": "Linear Regression 1",
    "section": "Summary",
    "text": "Summary\n\nsummary(mod2)\n\n\nCall:\nlm(formula = body_mass_g ~ species, data = penguins)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1126.0  -333.1   -33.1   316.9  1224.0 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)        3700.7       37.6   98.37   &lt;2e-16 ***\nspeciesChinstrap     32.4       67.5    0.48     0.63    \nspeciesGentoo      1375.4       56.1   24.50   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 462 on 339 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.67,  Adjusted R-squared:  0.668 \nF-statistic:  344 on 2 and 339 DF,  p-value: &lt;2e-16"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#forcing-the-reference-level",
    "href": "lecture_7_linear_regression1.html#forcing-the-reference-level",
    "title": "Linear Regression 1",
    "section": "Forcing the reference level",
    "text": "Forcing the reference level\nVery useful when you have a control\n\npenguins2 &lt;- penguins |&gt; \n  mutate(species = factor(species, levels = c(\"Gentoo\", \"Adelie\", \"Chinstrap\")))\n\nmod3 &lt;- lm(body_mass_g ~ species, data = penguins2)\n\n\nbroom::tidy(mod3)\n\n# A tibble: 3 × 5\n  term             estimate std.error statistic   p.value\n  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)         5076.      41.7     122.  6.86e-282\n2 speciesAdelie      -1375.      56.1     -24.5 5.42e- 77\n3 speciesChinstrap   -1343.      69.9     -19.2 3.21e- 56"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#multiple-comparisons",
    "href": "lecture_7_linear_regression1.html#multiple-comparisons",
    "title": "Linear Regression 1",
    "section": "Multiple comparisons",
    "text": "Multiple comparisons\nInstead of changing the order of the levels of the predictor variable to compare all groups against each other, use a post-hoc multiple comparisons test\n\n#multcomp loads plyr package which has lots of conflicts with dplyr\n# Solution - use conflicted package or multcomp::glht\n\nmc &lt;- multcomp::glht(mod2, linfct = multcomp::mcp(species = \"Tukey\"))\nsummary(mc)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#assumptions-of-least-squares",
    "href": "lecture_7_linear_regression1.html#assumptions-of-least-squares",
    "title": "Linear Regression 1",
    "section": "Assumptions of Least Squares",
    "text": "Assumptions of Least Squares\n\nThe relationship between the response and the predictors is ~linear.\nThe residuals have a mean of zero.\nThe residuals have constant variance (not heteroscedastic).\nThe residuals are independent (uncorrelated).\nThe residuals are normally distributed.\n\nViolation of assumptions cannot be detected using the t or F statistics or R2"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#diagnostic-plots",
    "href": "lecture_7_linear_regression1.html#diagnostic-plots",
    "title": "Linear Regression 1",
    "section": "Diagnostic plots",
    "text": "Diagnostic plots\n\nlibrary(ggfortify)\nautoplot(mod) # can also use plot(mod)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#residual-vs-fitted",
    "href": "lecture_7_linear_regression1.html#residual-vs-fitted",
    "title": "Linear Regression 1",
    "section": "Residual vs fitted",
    "text": "Residual vs fitted\n\n\nCheck for\n\nOutliers\nVariations in the mean residual\n\nWant flat line\n\n\nautoplot(mod, which = 1)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#quantile-quantile-plot",
    "href": "lecture_7_linear_regression1.html#quantile-quantile-plot",
    "title": "Linear Regression 1",
    "section": "Quantile-quantile plot",
    "text": "Quantile-quantile plot\n\n\nQQ plots compare two samples to determine if they are from the same distribution.\nCheck for\n\nNon-normal distribution of the residuals\n\nPoints will lie on straight line if normally distributed\n\n\nautoplot(mod, which = 2)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#scale-location-plot",
    "href": "lecture_7_linear_regression1.html#scale-location-plot",
    "title": "Linear Regression 1",
    "section": "Scale-location plot",
    "text": "Scale-location plot\n\n\nSquare root of the absolute standardised residuals\nCheck for\n\nUnequal variance = Heteroscedasticity\n\nWant flat line\n\n\nautoplot(mod, which = 3)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#cooks-distance",
    "href": "lecture_7_linear_regression1.html#cooks-distance",
    "title": "Linear Regression 1",
    "section": "Cook’s distance",
    "text": "Cook’s distance\n\n\nInfluence of individual points on the fitted values\n– how much do fitted values change when observation i removed\nPoints with a D &gt; 4/n merit examination\n\n\nautoplot(mod, which = 4)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#residuals-vs-leverage",
    "href": "lecture_7_linear_regression1.html#residuals-vs-leverage",
    "title": "Linear Regression 1",
    "section": "Residuals vs leverage",
    "text": "Residuals vs leverage\n\n\nPlot of standardised residuals against leverage, with contours of Cooks distance\nObservations with extreme leverage should be checked\n\n\nautoplot(mod, which = 5)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#cooks-distance-vs-leverage",
    "href": "lecture_7_linear_regression1.html#cooks-distance-vs-leverage",
    "title": "Linear Regression 1",
    "section": "Cook’s distance vs leverage",
    "text": "Cook’s distance vs leverage\n\n\nInfluence vs leverage with contours of standardised residuals\nCheck extreme observations\n\n\nautoplot(mod, which = 6)"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predictions",
    "href": "lecture_7_linear_regression1.html#predictions",
    "title": "Linear Regression 1",
    "section": "Predictions",
    "text": "Predictions\n\n\n\\[y = \\beta_0+\\beta_1x\\]"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predict",
    "href": "lecture_7_linear_regression1.html#predict",
    "title": "Linear Regression 1",
    "section": "Predict",
    "text": "Predict\n\npredict(object = mod)\n\n    1     2     3     4     5     6     7     8     9    10    11    12    13 \n45.15 50.06 44.94 50.06 48.83 45.35 46.38 48.01 44.74 47.81 45.76 49.44 45.76 \n   14    15    16    17    18    19    20    21    22    23    24    25    26 \n50.67 43.92 50.67 43.72 52.51 46.38 48.63 50.06 47.19 44.74 47.40 47.19 47.60 \n   27    28    29    30    31    32    33    34    35    36    37    38    39 \n43.51 49.85 45.56 49.44 48.22 45.97 47.40 51.49 47.81 48.83 46.99 48.22 44.53 \n   40    41    42    43    44    45    46    47    48    49    50    51    52 \n48.63 42.90 50.06 44.33 46.17 49.44 46.78 43.92 48.83 47.60 48.42 46.58 48.42 \n   53    54    55    56    57    58    59    60    61    62    63    64    65 \n44.74 47.19 46.78 47.40 44.33 47.19 44.94 49.44 43.92 48.42 44.74 49.85 45.97 \n   66    67    68    69    70    71    72    73    74    75    76    77    78 \n50.06 45.76 50.47 45.97 49.44 46.17 47.19 47.60 48.01 45.97 50.47 45.56 51.28 \n   79    80    81    82    83    84    85    86    87    88    89    90    91 \n46.17 51.08 45.66 49.03 46.07 48.63 46.17 49.65 45.56 48.42 46.68 49.44 46.99 \n   92    93    94    95    96    97    98    99   100   101   102   103   104 \n48.83 46.17 49.85 46.58 48.01 46.89 46.68 45.66 48.22 46.58 49.65 47.09 49.24 \n  105   106   107   108   109   110   111   112   113   114   115   116   117 \n46.07 49.24 45.97 49.24 45.46 49.24 47.19 51.08 45.76 49.24 44.64 50.67 46.68 \n  118   119   121   122   123   124 \n51.28 46.89 46.58 50.26 48.01 48.83"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predict-with-new-data",
    "href": "lecture_7_linear_regression1.html#predict-with-new-data",
    "title": "Linear Regression 1",
    "section": "Predict with new data",
    "text": "Predict with new data\n\nnd &lt;- tibble(body_mass_g = c(5000, 7000))\npredict(mod, newdata = nd)\n\n    1     2 \n47.19 55.38"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predictions-with-standard-errors",
    "href": "lecture_7_linear_regression1.html#predictions-with-standard-errors",
    "title": "Linear Regression 1",
    "section": "Predictions with standard errors",
    "text": "Predictions with standard errors\nUncertainty of the mean\n\npredict(mod, newdata = nd, se.fit = TRUE)\n\n$fit\n    1     2 \n47.19 55.38 \n\n$se.fit\n     1      2 \n0.2097 0.8212 \n\n$df\n[1] 121\n\n$residual.scale\n[1] 2.3"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predictions-with-confidence-interval",
    "href": "lecture_7_linear_regression1.html#predictions-with-confidence-interval",
    "title": "Linear Regression 1",
    "section": "Predictions with confidence interval",
    "text": "Predictions with confidence interval\n\npredict(mod, newdata = nd, interval = \"confidence\", level = 0.95)\n\n    fit   lwr   upr\n1 47.19 46.78 47.61\n2 55.38 53.75 57.00"
  },
  {
    "objectID": "lecture_7_linear_regression1.html#predictions-interval",
    "href": "lecture_7_linear_regression1.html#predictions-interval",
    "title": "Linear Regression 1",
    "section": "Predictions interval",
    "text": "Predictions interval\nWhere will a new observation probably be\n\naugment(mod, interval = \"prediction\") |&gt; \n  ggplot(aes(x = body_mass_g, y = bill_length_mm)) +\n  geom_point() +\n  geom_ribbon(aes(ymin = .lower, ymax = .upper), alpha = .3)+\n  geom_line(aes(y = .fitted))"
  },
  {
    "objectID": "lecture_5_experimental_design.html#starting-with-a-hypothesis",
    "href": "lecture_5_experimental_design.html#starting-with-a-hypothesis",
    "title": "Experimental Design",
    "section": "Starting with a hypothesis",
    "text": "Starting with a hypothesis\n\nProposed explanation for observations\nTestable\n\nNull hypothesis H0 - no relationship\nAlternative hypothesis H1 - relationship"
  },
  {
    "objectID": "lecture_5_experimental_design.html#testing-a-hypothesis---types-of-evidence",
    "href": "lecture_5_experimental_design.html#testing-a-hypothesis---types-of-evidence",
    "title": "Experimental Design",
    "section": "Testing a hypothesis - types of evidence",
    "text": "Testing a hypothesis - types of evidence\n\nObservational\nComputer simulations\nExperimental\nMeta analysis and systematic reviews\n\nWhich is better? Why are all needed?"
  },
  {
    "objectID": "lecture_5_experimental_design.html#dead-calluna-vulgaris",
    "href": "lecture_5_experimental_design.html#dead-calluna-vulgaris",
    "title": "Experimental Design",
    "section": "Dead Calluna vulgaris",
    "text": "Dead Calluna vulgaris\n\n\nlandpress"
  },
  {
    "objectID": "lecture_5_experimental_design.html#correlation-causation",
    "href": "lecture_5_experimental_design.html#correlation-causation",
    "title": "Experimental Design",
    "section": "Correlation != Causation",
    "text": "Correlation != Causation\n\n\n\n\n\nr = 0.95\n\n\nhttps://www.tylervigen.com/spurious-correlations]"
  },
  {
    "objectID": "lecture_5_experimental_design.html#drought-experiment",
    "href": "lecture_5_experimental_design.html#drought-experiment",
    "title": "Experimental Design",
    "section": "Drought experiment",
    "text": "Drought experiment\n\n\nlandpress"
  },
  {
    "objectID": "lecture_5_experimental_design.html#controls",
    "href": "lecture_5_experimental_design.html#controls",
    "title": "Experimental Design",
    "section": "Controls",
    "text": "Controls\n\nTurf transplants\nWarmer/Wetter\n\n\n\nSeedclim"
  },
  {
    "objectID": "lecture_5_experimental_design.html#bad-controls",
    "href": "lecture_5_experimental_design.html#bad-controls",
    "title": "Experimental Design",
    "section": "Bad controls",
    "text": "Bad controls\nAfter rotenone treatment have started, you want to test how the benthic fauna of a river is affected by the treatment."
  },
  {
    "objectID": "lecture_5_experimental_design.html#conditioned-samples",
    "href": "lecture_5_experimental_design.html#conditioned-samples",
    "title": "Experimental Design",
    "section": "Conditioned samples",
    "text": "Conditioned samples\nH0 : The parasite Schistocephalus solidus does not affect food intake of three-spined sticklebacks.\nDesign: You collect infected and uninfected fish from the field and compare their food intake in the laboratory."
  },
  {
    "objectID": "lecture_5_experimental_design.html#replication",
    "href": "lecture_5_experimental_design.html#replication",
    "title": "Experimental Design",
    "section": "Replication",
    "text": "Replication\nOne treatment and one control measurement not enough\n\nRandom variability\nNeed replication\nPower analysis to estimate how many replicates needed"
  },
  {
    "objectID": "lecture_5_experimental_design.html#randomisation",
    "href": "lecture_5_experimental_design.html#randomisation",
    "title": "Experimental Design",
    "section": "Randomisation",
    "text": "Randomisation\n\nreduces bias\nstratified random designs possible"
  },
  {
    "objectID": "lecture_5_experimental_design.html#unbalanced-design",
    "href": "lecture_5_experimental_design.html#unbalanced-design",
    "title": "Experimental Design",
    "section": "Unbalanced design",
    "text": "Unbalanced design\nIs an experiment with 100 treatment subjects and 10 control subjects valid?\nWhat about 57 treatment subjects and 53 control subjects?\nWhy might you get an unbalanced design?"
  },
  {
    "objectID": "lecture_5_experimental_design.html#pseudoreplication",
    "href": "lecture_5_experimental_design.html#pseudoreplication",
    "title": "Experimental Design",
    "section": "Pseudoreplication",
    "text": "Pseudoreplication\nWant to test the effect of different fish foods\nMass of each fish measured.\nCan each fish be treated as an independent observation in your analysis?\n\n\nWorldFish"
  },
  {
    "objectID": "lecture_5_experimental_design.html#confounding-factors",
    "href": "lecture_5_experimental_design.html#confounding-factors",
    "title": "Experimental Design",
    "section": "Confounding factors",
    "text": "Confounding factors\nYou have a hypothesis that age of a fish should affect parasite resistance because host age affects the immune system. But, size of a fish varies with age. Size may also affect the immune system. Thus, size may be a confounding factor in the experiment."
  },
  {
    "objectID": "lecture_5_experimental_design.html#blinding",
    "href": "lecture_5_experimental_design.html#blinding",
    "title": "Experimental Design",
    "section": "Blinding",
    "text": "Blinding\n\nTwo videos: pigs bred for social breeding value, controls\nCount positive and negative interactions\n\n\n\n\n\n\n\nSame pigs. Video inverted.\n\n\n\nTuyttens et al (2014)"
  },
  {
    "objectID": "lecture_5_experimental_design.html#examples",
    "href": "lecture_5_experimental_design.html#examples",
    "title": "Experimental Design",
    "section": "Examples",
    "text": "Examples\nAre there any problems with the following study designs?"
  },
  {
    "objectID": "lecture_5_experimental_design.html#study-1",
    "href": "lecture_5_experimental_design.html#study-1",
    "title": "Experimental Design",
    "section": "Study 1",
    "text": "Study 1\nYou want to test growth of salmon depending on three different food types. You have three aquaria with several fish and give one food type to each aquarium."
  },
  {
    "objectID": "lecture_5_experimental_design.html#study-2",
    "href": "lecture_5_experimental_design.html#study-2",
    "title": "Experimental Design",
    "section": "Study 2",
    "text": "Study 2\nYou want to test if a virus enlarges the liver cells of infected salmon. You measure 60 cells, 30 from a fish you have infected and 30 from an uninfected fish, respectively."
  },
  {
    "objectID": "lecture_5_experimental_design.html#study-3",
    "href": "lecture_5_experimental_design.html#study-3",
    "title": "Experimental Design",
    "section": "Study 3",
    "text": "Study 3\nYou have a D. pulex population in an aquarium and use these animals for an experiment. You place the daphnia individually in 70 ml jars, first the ones you will use as a treatment group, and then the control group. Then, you randomly place control and treatment jars in a climate chamber."
  },
  {
    "objectID": "lecture_3_data_manipulation.html#data-cleaning",
    "href": "lecture_3_data_manipulation.html#data-cleaning",
    "title": "Data manipulation",
    "section": "Data cleaning",
    "text": "Data cleaning\n\n\n\n\n\n\n\n\nCritical\nTime consuming\nDo in code for reproducibility\nOften not taught\n\n\n\nFigure from towards_AI"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#penguins",
    "href": "lecture_3_data_manipulation.html#penguins",
    "title": "Data manipulation",
    "section": "Penguins",
    "text": "Penguins\n\n\nlibrary(palmerpenguins)\npenguins\n\n# A tibble: 344 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n# ℹ 342 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\n\npalmerpenguins: Palmer Archipelago (Antarctica) Penguin Data\nSize measurements for adult foraging Adélie, Chinstrap, and Gentoo penguins observed on islands in the Palmer Archipelago, Antarctica."
  },
  {
    "objectID": "lecture_3_data_manipulation.html#pipes",
    "href": "lecture_3_data_manipulation.html#pipes",
    "title": "Data manipulation",
    "section": "Pipes",
    "text": "Pipes\nAnalysis:\n\nWith penguins data\nDrop rows with NA sex\nfind mean bill length per species per sex\n\nFirst solution\n\nsummarise(\n  group_by(drop_na(penguins, sex), species, sex), \n  bill_length_mean = mean(bill_length_mm),\n  .groups = \"drop\")\n\n# A tibble: 6 × 3\n  species sex    bill_length_mean\n  &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;\n1 Adelie  female             37.3\n2 Adelie  male               40.4\n# ℹ 4 more rows"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#tidy-data",
    "href": "lecture_3_data_manipulation.html#tidy-data",
    "title": "Data manipulation",
    "section": "Tidy data",
    "text": "Tidy data\n\n“Happy families are all alike; every unhappy family is unhappy in its own way”\n— Tolstoy\n\nTidy data\n\neasy to work with\nuse standard tools to manipulate, visualise and analyse\ncan reuse code from other projects"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#what-are-tidy-data",
    "href": "lecture_3_data_manipulation.html#what-are-tidy-data",
    "title": "Data manipulation",
    "section": "What are tidy data",
    "text": "What are tidy data\n\nEvery column is a variable.\nEvery row is an observation.\nEvery cell is a single value.\n\n\n\n\n\n\n\n\nWickham (2014) Tidy data"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#untidy-data",
    "href": "lecture_3_data_manipulation.html#untidy-data",
    "title": "Data manipulation",
    "section": "Untidy data",
    "text": "Untidy data\n\n\n\n\n\n\n\n\n\n\n\n\nDate\n17.06.2016\n21.06.2016\n23.06.2016\n26.06.2016\n\n\n\n\nTime\n10:00\n11:00\n11:00\n13:00\n\n\nWeather\nSunny_PartlyCloudy\nCloudy_Fog\nCloudy_Sunny\nCloudy_Rainy_Windy_Fog\n\n\nObserver\nLV_AH\nLV\nLV\nLV\n\n\nE01a\n0\nNA\n0\n0\n\n\nE01b\n0\nNA\n0\n0\n\n\nE01c\n0\nNA\n0\n0\n\n\nE01d\n0\nNA\n0\n0\n\n\nE01e\n0\nNA\n0\n0"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#the-heart-of-your-analysis-pipeline",
    "href": "lecture_3_data_manipulation.html#the-heart-of-your-analysis-pipeline",
    "title": "Data manipulation",
    "section": "The heart of your analysis pipeline",
    "text": "The heart of your analysis pipeline\n\n\n\n\n\n\ncirco\n\n\n\na1\n\n\n\n\nb\n\nTidy data\n\n\n\na1-&gt;b\n\n\n\n\n\na2\n\n\n\n\n\na2-&gt;b\n\n\n\n\n\na3\n\n\n\n\na3-&gt;b\n\n\n\n\n\nc\n\nClean & tidy data\n\n\n\nb-&gt;c\n\n\n\n\n\nd\n\nAnalysis\n\n\n\nc-&gt;d\n\n\n\n\n\ne\n\nVisualisation\n\n\n\nc-&gt;e"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#reshaping-data",
    "href": "lecture_3_data_manipulation.html#reshaping-data",
    "title": "Data manipulation",
    "section": "Reshaping data",
    "text": "Reshaping data\nLong data vs wide data"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#making-longer-data",
    "href": "lecture_3_data_manipulation.html#making-longer-data",
    "title": "Data manipulation",
    "section": "Making longer data",
    "text": "Making longer data\ntidyr::pivot_longer()\n\nmites_long &lt;- mites |&gt; \n  pivot_longer(cols = Brachy:RARD, \n               names_to = \"taxon\", \n               values_to = \"count\")\nmites_long\n\n# A tibble: 20 × 3\n   sample taxon  count\n    &lt;int&gt; &lt;chr&gt;  &lt;int&gt;\n 1      1 Brachy    17\n 2      1 PHTH       5\n 3      1 HPAV       5\n 4      1 RARD       3\n 5      2 Brachy     2\n 6      2 PHTH       7\n 7      2 HPAV      16\n 8      2 RARD       0\n 9      3 Brachy     4\n10      3 PHTH       3\n# ℹ 10 more rows"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#making-wider-data",
    "href": "lecture_3_data_manipulation.html#making-wider-data",
    "title": "Data manipulation",
    "section": "Making wider data",
    "text": "Making wider data\ntidyr::pivot_wider()\n\nmites_wide &lt;- mites_long |&gt; \n  pivot_wider(names_from = \"taxon\", \n              values_from = \"count\")\nmites_wide\n\n# A tibble: 5 × 5\n  sample Brachy  PHTH  HPAV  RARD\n   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;\n1      1     17     5     5     3\n2      2      2     7    16     0\n3      3      4     3     1     1\n4      4     23     7    10     2\n5      5      5     8    13     9"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#key-dplyr-functions",
    "href": "lecture_3_data_manipulation.html#key-dplyr-functions",
    "title": "Data manipulation",
    "section": "Key dplyr functions",
    "text": "Key dplyr functions\n\nselect()\nfilter()\nmutate()\nsummarise()\ngroup_by()\n\nNormally load dplyr with library(tidyverse)"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#selecting-columns",
    "href": "lecture_3_data_manipulation.html#selecting-columns",
    "title": "Data manipulation",
    "section": "Selecting columns",
    "text": "Selecting columns\ndplyr::select()\n\npenguins |&gt; \n  select(species, bill_length_mm)\n\n# A tibble: 344 × 2\n  species bill_length_mm\n  &lt;fct&gt;            &lt;dbl&gt;\n1 Adelie            39.1\n2 Adelie            39.5\n# ℹ 342 more rows\n\n\n\npenguins |&gt; \n  select(-bill_length_mm, -bill_depth_mm)\n\n# A tibble: 344 × 6\n  species island    flipper_length_mm body_mass_g sex     year\n  &lt;fct&gt;   &lt;fct&gt;                 &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;\n1 Adelie  Torgersen               181        3750 male    2007\n2 Adelie  Torgersen               186        3800 female  2007\n# ℹ 342 more rows"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#selecting-adjacent-columns",
    "href": "lecture_3_data_manipulation.html#selecting-adjacent-columns",
    "title": "Data manipulation",
    "section": "Selecting adjacent columns",
    "text": "Selecting adjacent columns\n\npenguins |&gt; \n  select(bill_length_mm:body_mass_g)\n\n# A tibble: 344 × 4\n  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1           39.1          18.7               181        3750\n2           39.5          17.4               186        3800\n# ℹ 342 more rows\n\n\n\npenguins |&gt; \n  select(-(bill_length_mm:body_mass_g))\n\n# A tibble: 344 × 4\n  species island    sex     year\n  &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;\n1 Adelie  Torgersen male    2007\n2 Adelie  Torgersen female  2007\n# ℹ 342 more rows"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#select-helpers",
    "href": "lecture_3_data_manipulation.html#select-helpers",
    "title": "Data manipulation",
    "section": "Select helpers",
    "text": "Select helpers\nends_with()\n\npenguins |&gt; \n  select(species, ends_with(\"mm\"))\n\n# A tibble: 344 × 4\n  species bill_length_mm bill_depth_mm flipper_length_mm\n  &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;\n1 Adelie            39.1          18.7               181\n2 Adelie            39.5          17.4               186\n# ℹ 342 more rows\n\n\n\nstarts_with()\ncontains()\nmatches() regular expressions"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#your-turn",
    "href": "lecture_3_data_manipulation.html#your-turn",
    "title": "Data manipulation",
    "section": "Your turn",
    "text": "Your turn\n\nnames(penguins)\n\n[1] \"species\"           \"island\"            \"bill_length_mm\"   \n[4] \"bill_depth_mm\"     \"flipper_length_mm\" \"body_mass_g\"      \n[7] \"sex\"               \"year\"             \n\n\nHow would you make a data frame with\n\njust species and island\nwithout year\nwith species and the length measurements"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#filtering-rows",
    "href": "lecture_3_data_manipulation.html#filtering-rows",
    "title": "Data manipulation",
    "section": "Filtering rows",
    "text": "Filtering rows\ndplyr::filter()\n\npenguins |&gt; filter(species == \"Gentoo\")\n\n# A tibble: 124 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Gentoo  Biscoe           46.1          13.2               211        4500\n2 Gentoo  Biscoe           50            16.3               230        5700\n# ℹ 122 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nOne or more logical statements\n\n==\n&gt;=\n&lt;\n!=\n\n\nseparate statements with commas"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#near",
    "href": "lecture_3_data_manipulation.html#near",
    "title": "Data manipulation",
    "section": "near()",
    "text": "near()\nProblem:\n\nsqrt(2) ^ 2 == 2\n\n\n\n[1] FALSE\n\n\n\n\nsqrt(2) ^ 2 - 2\n\n[1] 4.440892e-16\n\n\n\n\n\\(\\sqrt{2}\\) is irrational - cannot be perfectly represented\nSolution:\n\nnear(sqrt(2) ^ 2, 2)\n\n[1] TRUE\n\n\n\ndata stored as doubles - finite precision"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#in",
    "href": "lecture_3_data_manipulation.html#in",
    "title": "Data manipulation",
    "section": "%in%",
    "text": "%in%\nProblem\n\npenguins |&gt; \n  filter(species == \"Gentoo\" | species == \"Chinstrap\")\n\n# A tibble: 192 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Gentoo  Biscoe           46.1          13.2               211        4500\n2 Gentoo  Biscoe           50            16.3               230        5700\n# ℹ 190 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\n\n| OR\n\nSolution\n\npenguins |&gt; \n  filter(species %in% c(\"Gentoo\", \"Chinstrap\"))\n\n# A tibble: 192 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Gentoo  Biscoe           46.1          13.2               211        4500\n2 Gentoo  Biscoe           50            16.3               230        5700\n# ℹ 190 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#between",
    "href": "lecture_3_data_manipulation.html#between",
    "title": "Data manipulation",
    "section": "between()",
    "text": "between()\nProblem\n\npenguins |&gt; \n  filter(body_mass_g &gt;= 2000, body_mass_g &lt;= 3000)\n\n# A tibble: 11 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Dream            37            16.9               185        3000\n2 Adelie  Dream            37.5          18.9               179        2975\n# ℹ 9 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nSolution\n\npenguins |&gt; \n  filter(between(body_mass_g, left = 2000, right = 3000))\n\n# A tibble: 11 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Dream            37            16.9               185        3000\n2 Adelie  Dream            37.5          18.9               179        2975\n# ℹ 9 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#partial-string-matches",
    "href": "lecture_3_data_manipulation.html#partial-string-matches",
    "title": "Data manipulation",
    "section": "Partial string matches",
    "text": "Partial string matches\nProblem\nWant to filter by partial text match\nsolution: stringr package\n\npenguins |&gt; \n  filter(str_detect(species, \"G\"))\n\n# A tibble: 124 × 8\n  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Gentoo  Biscoe           46.1          13.2               211        4500\n2 Gentoo  Biscoe           50            16.3               230        5700\n# ℹ 122 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nRegular expressions for more powerful matching."
  },
  {
    "objectID": "lecture_3_data_manipulation.html#how-would-you",
    "href": "lecture_3_data_manipulation.html#how-would-you",
    "title": "Data manipulation",
    "section": "How would you",
    "text": "How would you\n\npenguins\n\n# A tibble: 344 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n# ℹ 342 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nGet a data frame with\n\nMale Gentoo penguins\nPenguins with a mass &gt; 1000 g\nPenguins from Dream or Biscoe Island"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#mutating-columns-with-mutate",
    "href": "lecture_3_data_manipulation.html#mutating-columns-with-mutate",
    "title": "Data manipulation",
    "section": "Mutating columns with mutate()",
    "text": "Mutating columns with mutate()\nMake a new column or change an existing column\n\npenguins |&gt; mutate(\n  species = tolower(species),\n  body_mass_kg = body_mass_g/1000,\n  bill_ratio = bill_length_mm/bill_depth_mm\n  )\n\n# A tibble: 344 × 10\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;chr&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 adelie  Torgersen           39.1          18.7               181        3750\n2 adelie  Torgersen           39.5          17.4               186        3800\n# ℹ 342 more rows\n# ℹ 4 more variables: sex &lt;fct&gt;, year &lt;int&gt;, body_mass_kg &lt;dbl&gt;,\n#   bill_ratio &lt;dbl&gt;"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#useful-functions-for-mutate",
    "href": "lecture_3_data_manipulation.html#useful-functions-for-mutate",
    "title": "Data manipulation",
    "section": "Useful functions for mutate",
    "text": "Useful functions for mutate\n\nmutate character columns with stringr, glue\nmutate factor columns with forcats\nmutate dates with lubridate"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#summarising-data-with-summarise",
    "href": "lecture_3_data_manipulation.html#summarising-data-with-summarise",
    "title": "Data manipulation",
    "section": "Summarising data with summarise",
    "text": "Summarising data with summarise\n\npenguins |&gt; \n  summarise(\n    max_mass = max(body_mass_g, na.rm = TRUE),\n    mean_bill_length = mean(bill_length_mm, na.rm = TRUE)\n  )\n\n# A tibble: 1 × 2\n  max_mass mean_bill_length\n     &lt;int&gt;            &lt;dbl&gt;\n1     6300             43.9\n\n\nUseful functions\n\nlimits min() max()\ncentre mean() median()\nspread sd()\nnumber n() n_distinct()"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#grouping-data",
    "href": "lecture_3_data_manipulation.html#grouping-data",
    "title": "Data manipulation",
    "section": "Grouping data",
    "text": "Grouping data\n\npenguins |&gt; \n  group_by(species, island)\n\n# A tibble: 344 × 8\n# Groups:   species, island [5]\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n# ℹ 342 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nMutate and summarise now work per group"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#mutating-grouped-data",
    "href": "lecture_3_data_manipulation.html#mutating-grouped-data",
    "title": "Data manipulation",
    "section": "Mutating grouped data",
    "text": "Mutating grouped data\nAnalysis per group\n\npenguins |&gt; \n  group_by(species) |&gt; \n  mutate(bill_length_mean = mean(bill_length_mm, na.rm = TRUE),\n         bill_length_centred = bill_length_mm - bill_length_mean)\n\n# A tibble: 344 × 10\n# Groups:   species [3]\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n# ℹ 342 more rows\n# ℹ 4 more variables: sex &lt;fct&gt;, year &lt;int&gt;, bill_length_mean &lt;dbl&gt;,\n#   bill_length_centred &lt;dbl&gt;"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#summarising-grouped-data",
    "href": "lecture_3_data_manipulation.html#summarising-grouped-data",
    "title": "Data manipulation",
    "section": "Summarising grouped data",
    "text": "Summarising grouped data\nSummary per group\n\npenguins |&gt; \n  group_by(species) |&gt; \n  summarise(\n    max_mass = max(body_mass_g),\n    mean_bill_length = mean(bill_length_mm),\n   .groups = \"drop\"\n  )\n\n# A tibble: 3 × 3\n  species   max_mass mean_bill_length\n  &lt;fct&gt;        &lt;int&gt;            &lt;dbl&gt;\n1 Adelie          NA             NA  \n2 Chinstrap     4800             48.8\n3 Gentoo          NA             NA"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#counting-rows",
    "href": "lecture_3_data_manipulation.html#counting-rows",
    "title": "Data manipulation",
    "section": "Counting rows",
    "text": "Counting rows\n\npenguins |&gt; \n  count(species, island, sex)\n\n# A tibble: 13 × 4\n  species island sex        n\n  &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;  &lt;int&gt;\n1 Adelie  Biscoe female    22\n2 Adelie  Biscoe male      22\n# ℹ 11 more rows\n\npenguins |&gt; \n  group_by(species, island, sex) |&gt; \n  summarise(n = n(), .groups = \"drop\")\n\n# A tibble: 13 × 4\n  species island sex        n\n  &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;  &lt;int&gt;\n1 Adelie  Biscoe female    22\n2 Adelie  Biscoe male      22\n# ℹ 11 more rows"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#mutating-joins",
    "href": "lecture_3_data_manipulation.html#mutating-joins",
    "title": "Data manipulation",
    "section": "Mutating joins",
    "text": "Mutating joins\nMerge two tibbles"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#left_join",
    "href": "lecture_3_data_manipulation.html#left_join",
    "title": "Data manipulation",
    "section": "left_join()",
    "text": "left_join()\n\n\n\nband_members\n\n# A tibble: 3 × 2\n  name  band   \n  &lt;chr&gt; &lt;chr&gt;  \n1 Mick  Stones \n2 John  Beatles\n3 Paul  Beatles\n\n\n\n\nband_instruments\n\n# A tibble: 3 × 2\n  name  plays \n  &lt;chr&gt; &lt;chr&gt; \n1 John  guitar\n2 Paul  bass  \n3 Keith guitar\n\n\n. . .\n\n\nband_members %&gt;% \n  left_join(band_instruments, by = join_by(name))\n\n# A tibble: 3 × 3\n  name  band    plays \n  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; \n1 Mick  Stones  &lt;NA&gt;  \n2 John  Beatles guitar\n3 Paul  Beatles bass"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#other-joins",
    "href": "lecture_3_data_manipulation.html#other-joins",
    "title": "Data manipulation",
    "section": "Other joins",
    "text": "Other joins\n\ninner_join()\nfull_join()"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#filtering-joins",
    "href": "lecture_3_data_manipulation.html#filtering-joins",
    "title": "Data manipulation",
    "section": "Filtering joins",
    "text": "Filtering joins\n\n#semi join\nband_members %&gt;% \n  semi_join(band_instruments, by = join_by(name))\n\n# A tibble: 2 × 2\n  name  band   \n  &lt;chr&gt; &lt;chr&gt;  \n1 John  Beatles\n2 Paul  Beatles\n\n#anti join\nband_members %&gt;% \n  anti_join(band_instruments, by = join_by(name))\n\n# A tibble: 1 × 2\n  name  band  \n  &lt;chr&gt; &lt;chr&gt; \n1 Mick  Stones"
  },
  {
    "objectID": "lecture_3_data_manipulation.html#further-reading",
    "href": "lecture_3_data_manipulation.html#further-reading",
    "title": "Data manipulation",
    "section": "Further reading",
    "text": "Further reading\nWickham et al. (2023) R for Data Science\nWickham, H. Advanced R"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#why-do-biologists-need-statistics-anyway",
    "href": "lecture_1_data_lifecycle.html#why-do-biologists-need-statistics-anyway",
    "title": "Data lifecycle",
    "section": "Why do biologists need statistics anyway?",
    "text": "Why do biologists need statistics anyway?\nWhy do YOU need\n\ndata handling skills\ndata visualisation skills\nstatistics skills"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#biology-is-applied-data-science",
    "href": "lecture_1_data_lifecycle.html#biology-is-applied-data-science",
    "title": "Data lifecycle",
    "section": "Biology is applied data science!",
    "text": "Biology is applied data science!\n\nNearly all papers include data visualisation and analysis\nNeed to be able to understand the methods used to evaluate paper\nNeed to be able to make visualisations and analyses for papers, reports, theses"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#changing-expectations",
    "href": "lecture_1_data_lifecycle.html#changing-expectations",
    "title": "Data lifecycle",
    "section": "Changing expectations",
    "text": "Changing expectations\n\nFAIR and open science\nReproducible research\n\nMost scientists ‘can’t replicate studies by their peers’"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-life-cycle",
    "href": "lecture_1_data_lifecycle.html#data-life-cycle",
    "title": "Data lifecycle",
    "section": "Data life-cycle",
    "text": "Data life-cycle\n\n\n\n\n\n\ncirco\n\n\n\na\n\nDesign\n\n\n\nb\n\nGather\n\n\n\na-&gt;b\n\n\n\n\n\nb2\n\nEnter\n\n\n\nb-&gt;b2\n\n\n\n\n\nb3\n\nImport\n\n\n\nb2-&gt;b3\n\n\n\n\n\nd\n\nClean\n\n\n\nb3-&gt;d\n\n\n\n\n\ne\n\nVisualise\n\n\n\nd-&gt;e\n\n\n\n\n\nf\n\nAnalyse\n\n\n\nd-&gt;f\n\n\n\n\n\ne-&gt;d\n\n\n\n\n\ne-&gt;f\n\n\n\n\n\ng\n\nCommunicate\n\n\n\ne-&gt;g\n\n\n\n\n\nf-&gt;d\n\n\n\n\n\nf-&gt;e\n\n\n\n\n\nf-&gt;g\n\n\n\n\n\nh\n\nArchive\n\n\n\ng-&gt;h\n\n\n\n\n\ni\n\nDeath\n\n\n\ng-&gt;i\n\n\n\n\n\nj\n\nFind & Reuse\n\n\n\nh-&gt;j\n\n\n\n\n\nj-&gt;b3"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#experimental-design",
    "href": "lecture_1_data_lifecycle.html#experimental-design",
    "title": "Data lifecycle",
    "section": "Experimental Design",
    "text": "Experimental Design\nLecture 5\n\nObservational studies vs experiments\nRandomisation\nHow many replicates do you need?\nStatistical traps"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-entry",
    "href": "lecture_1_data_lifecycle.html#data-entry",
    "title": "Data lifecycle",
    "section": "Data entry",
    "text": "Data entry\n\nMake your data easy to import.\nProof read & data validation\nLock data file. No more edits."
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#spreadsheets",
    "href": "lecture_1_data_lifecycle.html#spreadsheets",
    "title": "Data lifecycle",
    "section": "Spreadsheets",
    "text": "Spreadsheets\nPractical recommendations for organizing spreadsheet data to reduce errors and ease later analyses.\n\nbe consistent\nwrite dates as YYYY-MM-DD\ndo not leave any cells empty\nput just one thing in a cell\norganize the data as a single rectangle (rows = subjects; columns = variables; single header row)\ncreate a data dictionary\ndo not include calculations in the raw data files\ndo not use font, colour or highlighting as data\nchoose good names for things\nuse data validation to avoid data entry errors\nsave the data in plain text files.\n\n\n\nBroman & Woo (2018) Data Organization in Spreadsheets"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#examples",
    "href": "lecture_1_data_lifecycle.html#examples",
    "title": "Data lifecycle",
    "section": "Examples",
    "text": "Examples\nWhen is 1-9-2021?\nSex coded as 0 & 1"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-importing",
    "href": "lecture_1_data_lifecycle.html#data-importing",
    "title": "Data lifecycle",
    "section": "Data importing",
    "text": "Data importing\nR can import almost any data type.\n\nCSV files with readr\nExcel files with readxl\nshapefiles with sf\nNetCDF with ncdf4"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-cleaning",
    "href": "lecture_1_data_lifecycle.html#data-cleaning",
    "title": "Data lifecycle",
    "section": "Data cleaning",
    "text": "Data cleaning\n\nProcess your data with code\nReproducible analyses\ntidyverse (Lecture 3)\n\n\nlibrary(tidyverse)\ndata(penguins, package = \"palmerpenguins\")\npenguins |&gt;\n  group_by(species) |&gt;\n  summarise(\n    n = n(),\n    mean_mass = mean(body_mass_g, na.rm = TRUE))\n\n# A tibble: 3 × 3\n  species       n mean_mass\n  &lt;fct&gt;     &lt;int&gt;     &lt;dbl&gt;\n1 Adelie      152     3701.\n2 Chinstrap    68     3733.\n3 Gentoo      124     5076."
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#visualise-with-ggplot2",
    "href": "lecture_1_data_lifecycle.html#visualise-with-ggplot2",
    "title": "Data lifecycle",
    "section": "Visualise with ggplot2",
    "text": "Visualise with ggplot2\n\nlibrary(ggplot2)\nlibrary(ggbeeswarm)\nggplot(penguins, aes(x = species,\n                     y = bill_length_mm,\n                     colour = species)) +\n  geom_beeswarm() +\n  scale_colour_brewer(palette = \"Set1\") +\n  labs(x = \"Species\", y = \"Bill length mm\", colour = \"Species\") +\n  theme_bw(base_size = 16)"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-analysis",
    "href": "lecture_1_data_lifecycle.html#data-analysis",
    "title": "Data lifecycle",
    "section": "Data analysis",
    "text": "Data analysis\nHuge number of statistical methods\nThis course will focus on\n\nExploratory data analysis (6)\nDescriptive statistics (6)\nLinear models (7--8)\nGeneralised linear models (9)\nMixed effect models (10)\nSurvival analysis (11)"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#communicate-results-with-quarto",
    "href": "lecture_1_data_lifecycle.html#communicate-results-with-quarto",
    "title": "Data lifecycle",
    "section": "Communicate results with quarto",
    "text": "Communicate results with quarto\nTradition\n\ntext in Word, code in R\ncopy figures, tables etc into Word\nfind mistakes. Return to step 2.\n\nquarto markdown\n\nCode and text interwoven\nReproducible, dynamic documents\nThis presentation made with quarto"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-death",
    "href": "lecture_1_data_lifecycle.html#data-death",
    "title": "Data lifecycle",
    "section": "Data death",
    "text": "Data death\n\n\n\n\n\nNatural degradation in information content associated with data and metadata\n\n\nMichener (2006)"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#empirical-evidence-of-data-loss",
    "href": "lecture_1_data_lifecycle.html#empirical-evidence-of-data-loss",
    "title": "Data lifecycle",
    "section": "Empirical evidence of data loss",
    "text": "Empirical evidence of data loss\n\n\n\n\n\n\n\n\nmorphological dimensions from plants or animals\nexamined the availability of data from 516 studies between 2 and 22 years old\nThe odds of a data set being reported as extant fell by 17% per year\nBroken e-mails and obsolete storage devices were the main obstacles to data sharing\nPolicies mandating data archiving at publication are clearly needed\n\n\n\nVines et al. (2014)"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#what-would-happen-if-you-lost-all-of-your-research-data",
    "href": "lecture_1_data_lifecycle.html#what-would-happen-if-you-lost-all-of-your-research-data",
    "title": "Data lifecycle",
    "section": "What would happen if you lost all of your research data?",
    "text": "What would happen if you lost all of your research data?\n\nI was focussed on creating high resolution, 3D time lapse videos of developing crustacean embryos, so all of my work was digital-based. When I lost my laptop and backups, I lost 400GB of data and close to four years of work. As a direct result I ended up getting an MPhil rather than the PhD I’d been working towards. I was hoping to have an illustrious career in science and for a time it seemed like everything would be stopped in its tracks.\n\n\n\nBilly Hinchen"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#obsolescent-storage-equipment",
    "href": "lecture_1_data_lifecycle.html#obsolescent-storage-equipment",
    "title": "Data lifecycle",
    "section": "Obsolescent storage equipment",
    "text": "Obsolescent storage equipment\n\n\nOne in stock at Amazon"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#back-up-your-raw-data",
    "href": "lecture_1_data_lifecycle.html#back-up-your-raw-data",
    "title": "Data lifecycle",
    "section": "Back up your raw data!",
    "text": "Back up your raw data!\n\nKeep raw data\nMultiple places\nPhysical and cloud services\nBe paranoid!"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#archiving-data",
    "href": "lecture_1_data_lifecycle.html#archiving-data",
    "title": "Data lifecycle",
    "section": "Archiving data",
    "text": "Archiving data\nMany research funders and journals demand data archiving.\n\nsubject specific archives\n\nGeneBank\nGBIF\n\nGeneralist repositories\n\nDRYAD\nOSF\nZenodo\n\nUniversity based\n\nDataverseNO\n\n\n\n\nOpen Access to Research Data"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#special-problems",
    "href": "lecture_1_data_lifecycle.html#special-problems",
    "title": "Data lifecycle",
    "section": "Special problems",
    "text": "Special problems\nSensitive data\n\n\nExamples\n\nSolutions"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#data-management-plans",
    "href": "lecture_1_data_lifecycle.html#data-management-plans",
    "title": "Data lifecycle",
    "section": "Data management plans",
    "text": "Data management plans\nHow data are to be collected and handled both during a research project, and after the project is completed\nWrite one before you start work.\n\n\n\n\n\n\n\nUiB Library"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#fair-principles",
    "href": "lecture_1_data_lifecycle.html#fair-principles",
    "title": "Data lifecycle",
    "section": "FAIR principles",
    "text": "FAIR principles\n\nFindable\nAccessible\nInteroperable\nReusable\n\nMeta data is as important as data.\n\nMetadata is structured information that describes, explains, locates, and makes it easier to retrieve and use an information resource."
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#why",
    "href": "lecture_1_data_lifecycle.html#why",
    "title": "Data lifecycle",
    "section": "Why ?",
    "text": "Why ?\n\nfree\nopen source\nlarge and friendly user community\nmany statistical methods implemented\nmakes publication ready figures\nreproducible research\ncode is easy to share and publish."
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#r-gui",
    "href": "lecture_1_data_lifecycle.html#r-gui",
    "title": "Data lifecycle",
    "section": "R GUI",
    "text": "R GUI\n\nYou probably never need to open R directly."
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#rstudio-ide",
    "href": "lecture_1_data_lifecycle.html#rstudio-ide",
    "title": "Data lifecycle",
    "section": "RStudio IDE",
    "text": "RStudio IDE"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#getting-the-best-out-of-rstudio",
    "href": "lecture_1_data_lifecycle.html#getting-the-best-out-of-rstudio",
    "title": "Data lifecycle",
    "section": "Getting the best out of RStudio",
    "text": "Getting the best out of RStudio\n\nprojects\nkeep track of everything\ncode completion\nbracket matching"
  },
  {
    "objectID": "lecture_1_data_lifecycle.html#getting-help",
    "href": "lecture_1_data_lifecycle.html#getting-help",
    "title": "Data lifecycle",
    "section": "Getting help",
    "text": "Getting help\n?length - find function length in open packages\n??length - help search\nStackoverflow.com\nGoogle error messages\nAI\nChatGPT\nPhind"
  },
  {
    "objectID": "delme.html#side-1",
    "href": "delme.html#side-1",
    "title": "Template for r-shinylive Quarto document",
    "section": "side 1",
    "text": "side 1\n#| standalone: true\n#| viewerHeight: 600\nlibrary(shiny)\nlibrary(bslib)\n\n# Define UI for app that draws a histogram ----\nui &lt;- page_sidebar(\n  sidebar = sidebar(open = \"open\",\n    numericInput(\"n\", \"Sample count\", 100),\n    checkboxInput(\"pause\", \"Pause\", FALSE),\n  ),\n  plotOutput(\"plot\", width=1100)\n)\n\nserver &lt;- function(input, output, session) {\n  data &lt;- reactive({\n    input$resample\n    if (!isTRUE(input$pause)) {\n      invalidateLater(1000)\n    }\n    rnorm(input$n)\n  })\n  \n  output$plot &lt;- renderPlot({\n    hist(data(),\n      breaks = 40,\n      xlim = c(-2, 2),\n      ylim = c(0, 1),\n      lty = \"blank\",\n      xlab = \"value\",\n      freq = FALSE,\n      main = \"\"\n    )\n    \n    x &lt;- seq(from = -2, to = 2, length.out = 500)\n    y &lt;- dnorm(x)\n    lines(x, y, lwd=1.5)\n    \n    lwd &lt;- 5\n    abline(v=0, col=\"red\", lwd=lwd, lty=2)\n    abline(v=mean(data()), col=\"blue\", lwd=lwd, lty=1)\n\n    legend(legend = c(\"Normal\", \"Mean\", \"Sample mean\"),\n      col = c(\"black\", \"red\", \"blue\"),\n      lty = c(1, 2, 1),\n      lwd = c(1, lwd, lwd),\n      x = 1,\n      y = 0.9\n    )\n  }, res=140)\n}\nshinyApp(ui, server)"
  },
  {
    "objectID": "delme.html#slide-2",
    "href": "delme.html#slide-2",
    "title": "Template for r-shinylive Quarto document",
    "section": "slide 2",
    "text": "slide 2\nsdfgh"
  },
  {
    "objectID": "bio300b_logistics.html#who-am-i",
    "href": "bio300b_logistics.html#who-am-i",
    "title": "Bio300B Logistics 2023",
    "section": "Who am I?",
    "text": "Who am I?\n\n\n\n\n\n\n\nemail: richard.telford@uib.no\n\n\nPalaeoecologist/ecologist with numerical interests\nR user since 2002\nInterested in\n\nReconstructing environmental change\nEffect of climate change on ecosystems\nReproducibility in science"
  },
  {
    "objectID": "bio300b_logistics.html#teaching-assistants",
    "href": "bio300b_logistics.html#teaching-assistants",
    "title": "Bio300B Logistics 2023",
    "section": "Teaching Assistants",
    "text": "Teaching Assistants\n\n\nLotta Schultz\n\n\n\n\n\nInterests in global change ecology, biogeography and conservation biology.\n\nFrancesco Saltalamacchia\n\n\n\n\n\nEffects of hypoxia on fish in West Norwegian fjords"
  },
  {
    "objectID": "bio300b_logistics.html#students",
    "href": "bio300b_logistics.html#students",
    "title": "Bio300B Logistics 2023",
    "section": "Students",
    "text": "Students\n93 Students\n\n\nR users\nRStudio"
  },
  {
    "objectID": "bio300b_logistics.html#lectures",
    "href": "bio300b_logistics.html#lectures",
    "title": "Bio300B Logistics 2023",
    "section": "Lectures",
    "text": "Lectures\n\nStart Monday 28th August 1415–1600\nThereafter Monday 1215–1400\nHøyteknologisenteret, Stort auditorium\n\nWill be recorded when clashes with other courses\n\nBio325 (25th Sept / 2nd Oct)\n???\n\n\n\nAny other courses? When?"
  },
  {
    "objectID": "bio300b_logistics.html#printing-lecture-notes",
    "href": "bio300b_logistics.html#printing-lecture-notes",
    "title": "Bio300B Logistics 2023",
    "section": "Printing Lecture notes",
    "text": "Printing Lecture notes\nSlides made with quarto & revealjs\n\nToggle into Print View using the E key (or using the Navigation Menu)\nOpen the browser’s print dialogue ().\nChange the Destination setting to Save as PDF.\nChange the Layout to Landscape.\nChange the Margins to None.\nEnable the Background graphics option.\nClick Save 🎉"
  },
  {
    "objectID": "bio300b_logistics.html#data-labs",
    "href": "bio300b_logistics.html#data-labs",
    "title": "Bio300B Logistics 2023",
    "section": "Data labs",
    "text": "Data labs\n3 Groups per week\n\n\n\nGroup 1\nTuesday 1215–1400\nK1 + K2 (Bio Blokk B)\n\n\nGroup 2\nTuesday 1415–1600\nK3 + K4 (Bio Blokk B)\n\n\nGroup 3\nWednesday 1015–1200\nK3 + K4 (Bio Blokk B)\n\n\n\nPlease sign up for one group\nPossible to change group if space available\n\n\n2 hour practicals\nneed to prepare"
  },
  {
    "objectID": "bio300b_logistics.html#assessment",
    "href": "bio300b_logistics.html#assessment",
    "title": "Bio300B Logistics 2023",
    "section": "Assessment",
    "text": "Assessment\nPortfolio assessment\n\nsubmissions on different aspects of the course\n\nSix assignments, best five are counted\n\nextra work for PhD on heisemner\n\n\n\ncan skip one without penalty\ndeadline after datalab to allow for last-minute fixes\nextensions available e.g. if you/family member are sick. please tell me"
  },
  {
    "objectID": "bio300b_logistics.html#hours",
    "href": "bio300b_logistics.html#hours",
    "title": "Bio300B Logistics 2023",
    "section": "Hours",
    "text": "Hours\n5 Credit course\n125–150 hours\n12 weeks\n~ 10–12 hours per week"
  },
  {
    "objectID": "bio300b_logistics.html#course-contents",
    "href": "bio300b_logistics.html#course-contents",
    "title": "Bio300B Logistics 2023",
    "section": "Course contents",
    "text": "Course contents\n\nUsing R with RStudio\nImporting and manipulating data with tidyverse\nData visualisation with ggplot2\nExecutable documents with quarto\nExperimental design & Power analysis\nLinear regression\nGeneralised linear regression\nMixed effect models\nSurvival analysis"
  },
  {
    "objectID": "bio300b_logistics.html#software-requirements",
    "href": "bio300b_logistics.html#software-requirements",
    "title": "Bio300B Logistics 2023",
    "section": "Software requirements",
    "text": "Software requirements\n\nR version &gt;= 4.3\nRStudio version &gt;= 2023.03.0\nquarto\n\nFor installation & configuration instructions see Chapter 1 of the Working in R coursebook"
  },
  {
    "objectID": "bio300b_logistics.html#r-packages",
    "href": "bio300b_logistics.html#r-packages",
    "title": "Bio300B Logistics 2023",
    "section": "R packages",
    "text": "R packages\n\ntidyverse (for data manipulation and plotting)\nremotes (for installing packages from GitHub)\nusethis (for setting up some course material)\nhere (for helping load file)\ngt (for making tables)\nquarto (for making reproducible documents)\n\nSee Chapter 5 of the Working in R coursebook\n(more packages will be needed later in the course)"
  },
  {
    "objectID": "bio300b_logistics.html#biostats-products",
    "href": "bio300b_logistics.html#biostats-products",
    "title": "Bio300B Logistics 2023",
    "section": "Biostats products",
    "text": "Biostats products\nEnough R to write a thesis\n\n\n\n\n\nR books\nInteractive tutorials & apps"
  },
  {
    "objectID": "bio300b_logistics.html#found-a-mistake-got-a-suggestion",
    "href": "bio300b_logistics.html#found-a-mistake-got-a-suggestion",
    "title": "Bio300B Logistics 2023",
    "section": "Found a mistake / got a suggestion?",
    "text": "Found a mistake / got a suggestion?\nMake an issue on github\n\nBooks\nInteractive tutorials & apps\nLecture notes"
  },
  {
    "objectID": "bio300b_logistics.html#reading",
    "href": "bio300b_logistics.html#reading",
    "title": "Bio300B Logistics 2023",
    "section": "Reading",
    "text": "Reading\n\n\nR for Data Science\n\n\n\n\n\n\nFundamentals of Data Visualization\n\n\n\n\n\n\nIntroduction to Modern Statistics"
  },
  {
    "objectID": "bio300b_logistics.html#bio-courses",
    "href": "bio300b_logistics.html#bio-courses",
    "title": "Bio300B Logistics 2023",
    "section": "Bio courses",
    "text": "Bio courses\n\nBIO303 Ordination and Gradient Analysis\n\nAutumn semester\n\nBio302 Biostatisics II\n\nSpring semester"
  },
  {
    "objectID": "bio300b_logistics.html#rklubben",
    "href": "bio300b_logistics.html#rklubben",
    "title": "Bio300B Logistics 2023",
    "section": "Rklubben",
    "text": "Rklubben\n“The first rule about R club is you talk about R.”\n\nCome and help fix someone else’s R problems\nAnd get help yourself\n\nFridays 1400-1600 in Tunet (4th floor Bio A)\nZoom possible on request"
  },
  {
    "objectID": "bio300b_logistics.html#any-questions",
    "href": "bio300b_logistics.html#any-questions",
    "title": "Bio300B Logistics 2023",
    "section": "Any questions?",
    "text": "Any questions?\n???"
  },
  {
    "objectID": "lecture_2_using_r.html#r-as-a-calculator",
    "href": "lecture_2_using_r.html#r-as-a-calculator",
    "title": "Using R",
    "section": "R as a calculator",
    "text": "R as a calculator\n\n6 * 7\n\n\n\n[1] 42\n\n(2 + 5) * 8\n\n[1] 56"
  },
  {
    "objectID": "lecture_2_using_r.html#assigning",
    "href": "lecture_2_using_r.html#assigning",
    "title": "Using R",
    "section": "Assigning",
    "text": "Assigning\nAssign object to a name\n\nx &lt;- 6 * 7\nx\n\n\n\n[1] 42\n\nx ^ 2\n\n[1] 1764\n\n\nForgetting to assign is a very common error"
  },
  {
    "objectID": "lecture_2_using_r.html#functions",
    "href": "lecture_2_using_r.html#functions",
    "title": "Using R",
    "section": "Functions",
    "text": "Functions\nBrackets\nArguments separated by comma\n\nrnorm(n = 4, mean = 2, sd = 2)\n\n[1] -1.011889  2.257745  4.135424  3.409530\n\n\nDon’t include an argument - uses default\nDon’t need to name arguments if in correct order\n\nrnorm(4, 2, 2)"
  },
  {
    "objectID": "lecture_2_using_r.html#vectors",
    "href": "lecture_2_using_r.html#vectors",
    "title": "Using R",
    "section": "Vectors",
    "text": "Vectors\nAll elements must be the same type\nAtomic vectors\n\nc(TRUE, FALSE, TRUE)    # logical\n\n[1]  TRUE FALSE  TRUE\n\nc(1L, 5L, 19L)          # integer\n\n[1]  1  5 19\n\nc(3.14, 1, 1.9e2)       # double\n\n[1]   3.14   1.00 190.00\n\nc(\"cat\", \"dog\", \"fish\") # character\n\n[1] \"cat\"  \"dog\"  \"fish\""
  },
  {
    "objectID": "lecture_2_using_r.html#coercion",
    "href": "lecture_2_using_r.html#coercion",
    "title": "Using R",
    "section": "Coercion",
    "text": "Coercion\nAutomatic coercion\n\nx &lt;- c(1, \"dog\")\nmode(x)\n\n\n\n[1] \"character\"\n\nx\n\n[1] \"1\"   \"dog\"\n\n\n\nDeliberate coercion\n\nas.numeric(x)\n\n[1]  1 NA"
  },
  {
    "objectID": "lecture_2_using_r.html#subsetting-a-vector",
    "href": "lecture_2_using_r.html#subsetting-a-vector",
    "title": "Using R",
    "section": "Subsetting a vector",
    "text": "Subsetting a vector\n\nx &lt;- c(5, 1, 4, 7)\nx[2]       # extract single element\n\n[1] 1\n\nx[c(1, 3)] # extract multiple elements\n\n[1] 5 4\n\nx[-2]      # remove elements\n\n[1] 5 4 7\n\nx[x &gt; 5]   # logical test\n\n[1] 7"
  },
  {
    "objectID": "lecture_2_using_r.html#matricies",
    "href": "lecture_2_using_r.html#matricies",
    "title": "Using R",
    "section": "Matricies",
    "text": "Matricies\n2 dimensional\nAll elements same type\n\nm &lt;- matrix(1:9, nrow = 3)\nm\n\n     [,1] [,2] [,3]\n[1,]    1    4    7\n[2,]    2    5    8\n[3,]    3    6    9\n\n\nArrays can have 3+ dimensions"
  },
  {
    "objectID": "lecture_2_using_r.html#subsetting-a-matrix",
    "href": "lecture_2_using_r.html#subsetting-a-matrix",
    "title": "Using R",
    "section": "Subsetting a matrix",
    "text": "Subsetting a matrix\n\nm\n\n     [,1] [,2] [,3]\n[1,]    1    4    7\n[2,]    2    5    8\n[3,]    3    6    9\n\n\n[row_indices, column_indices]\n\nm[1:2, 2]\n\n\n\n[1] 4 5"
  },
  {
    "objectID": "lecture_2_using_r.html#lists",
    "href": "lecture_2_using_r.html#lists",
    "title": "Using R",
    "section": "Lists",
    "text": "Lists\nEach element of a list can be a different type\n\nlst &lt;- list(\n  1:5,\n  \"b\",\n  c(TRUE, FALSE)\n)\n\nstr(lst)\n\nList of 3\n $ : int [1:5] 1 2 3 4 5\n $ : chr \"b\"\n $ : logi [1:2] TRUE FALSE\n\nlst\n\n[[1]]\n[1] 1 2 3 4 5\n\n[[2]]\n[1] \"b\"\n\n[[3]]\n[1]  TRUE FALSE\n\n\n\nLists are very important"
  },
  {
    "objectID": "lecture_2_using_r.html#subsetting-a-list",
    "href": "lecture_2_using_r.html#subsetting-a-list",
    "title": "Using R",
    "section": "Subsetting a list",
    "text": "Subsetting a list\n\nx &lt;- list(1:3, \"a\", 4:6)\n\n\n\n\n\n\nCan make a smaller list, or extract contents of a carriage"
  },
  {
    "objectID": "lecture_2_using_r.html#named-lists",
    "href": "lecture_2_using_r.html#named-lists",
    "title": "Using R",
    "section": "Named lists",
    "text": "Named lists\n\nx &lt;- list(a = 1:3, b = \"a\", c = 4:6)\nx\n\n$a\n[1] 1 2 3\n\n$b\n[1] \"a\"\n\n$c\n[1] 4 5 6\n\n\nExtract vector “a”\n\nx$a\n\n[1] 1 2 3"
  },
  {
    "objectID": "lecture_2_using_r.html#data-frames-and-tibbles",
    "href": "lecture_2_using_r.html#data-frames-and-tibbles",
    "title": "Using R",
    "section": "Data frames and tibbles",
    "text": "Data frames and tibbles\nrectangular data structure - 2-dimensions\ncolumns can have different type of object\nspecial type of list where all vectors have same length\nTibbles are better behaved version of data.frame\n\nlibrary(tibble) # part of tidyverse\ndf2 &lt;- tibble(x = 1:3, y = letters[1:3])\ndf2\n\n# A tibble: 3 × 2\n      x y    \n  &lt;int&gt; &lt;chr&gt;\n1     1 a    \n2     2 b    \n3     3 c"
  },
  {
    "objectID": "lecture_2_using_r.html#subsetting-a-tibble",
    "href": "lecture_2_using_r.html#subsetting-a-tibble",
    "title": "Using R",
    "section": "Subsetting a tibble",
    "text": "Subsetting a tibble\nWith square brackets\n\ndf2[1, 2]\n\n# A tibble: 1 × 1\n  y    \n  &lt;chr&gt;\n1 a    \n\n\nWith column names\n\ndf2$y\n\n[1] \"a\" \"b\" \"c\"\n\n\nWhich method is safer?\nCan also use dplyr package."
  },
  {
    "objectID": "lecture_2_using_r.html#control-flow",
    "href": "lecture_2_using_r.html#control-flow",
    "title": "Using R",
    "section": "Control flow",
    "text": "Control flow\nif statements for choice\n\nif (logical_condition) {\n  # run this code if logical_condition is true\n} else {\n  # run this code if logical_condition is false\n}\n\nelse is optional\nuse ifelse() or dplyr::case_when() for vectorised if"
  },
  {
    "objectID": "lecture_2_using_r.html#boolean-logic",
    "href": "lecture_2_using_r.html#boolean-logic",
    "title": "Using R",
    "section": "Boolean logic",
    "text": "Boolean logic\nlogical conditions can be combined\n\nanimal &lt;- \"cat\"\nnumber &lt;- 3\n\n\n&& AND - TRUE if both TRUE\n|| OR - TRUE if either TRUE\n! NOT - TRUE if FALSE (or use !=)\n\n\nanimal == \"cat\" && number == 7\n\n[1] FALSE\n\nanimal == \"cat\" || number == 7\n\n[1] TRUE\n\n!animal == \"cat\" || number == 7\n\n[1] FALSE\n\n!(animal == \"cat\" || number == 7)\n\n[1] FALSE"
  },
  {
    "objectID": "lecture_2_using_r.html#vectorised-boolean-logic",
    "href": "lecture_2_using_r.html#vectorised-boolean-logic",
    "title": "Using R",
    "section": "Vectorised Boolean logic",
    "text": "Vectorised Boolean logic\n&& and || return a single TRUE/FALSE\nUseful for if statements\n& and | return a vector of TRUE/FALSE\nUseful with ifelse() or dplyr::case_when()\n\na &lt;- 1:10\nb &lt;- rep(c(\"cat\", \"dog\"), 5)\n\na &gt; 5 && b == \"dog\" # gives error\n\nError in a &gt; 5 && b == \"dog\": 'length = 10' in coercion to 'logical(1)'\n\na &gt; 5 & b == \"dog\"\n\n [1] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE  TRUE"
  },
  {
    "objectID": "lecture_2_using_r.html#loops",
    "href": "lecture_2_using_r.html#loops",
    "title": "Using R",
    "section": "loops",
    "text": "loops\nOften don’t need an explicit loop - R is vectorised\n\na &lt;- c(5, 1, 4, 6)\nb &lt;- c(1, 7, 3, 4)\na + b\n\n[1]  6  8  7 10"
  },
  {
    "objectID": "lecture_2_using_r.html#for-loops",
    "href": "lecture_2_using_r.html#for-loops",
    "title": "Using R",
    "section": "for loops",
    "text": "for loops\nfor loops iterate over elements of a vector\n\nfor (element in vector){\n  # run code here\n}\n\n\n\nfor (i in 1:3) {\n  i ^ 2\n}"
  },
  {
    "objectID": "lecture_2_using_r.html#for-pitfalls",
    "href": "lecture_2_using_r.html#for-pitfalls",
    "title": "Using R",
    "section": "for pitfalls",
    "text": "for pitfalls\nNeed to pre-allocate space or slow\n\nn &lt;- 10\nresult &lt;- numeric(10)\nfor (i in 1:n) {\n  result[i] &lt;- rnorm(1)\n}\n\nRarely need a loop - purrr::map(), apply() generally cleaner"
  },
  {
    "objectID": "lecture_2_using_r.html#better-iteration-with-map",
    "href": "lecture_2_using_r.html#better-iteration-with-map",
    "title": "Using R",
    "section": "Better iteration with `map`",
    "text": "Better iteration with `map`\n\nlibrary(purrr) # part of tidyverse\nlst &lt;- list(a = 1:3, b = c(4, 7), c = 5:9)\nmap(lst, mean)\n\n$a\n[1] 2\n\n$b\n[1] 5.5\n\n$c\n[1] 7\n\nmap_dbl(lst, mean) # returns vector of doubles\n\n  a   b   c \n2.0 5.5 7.0 \n\n\napply for iterating over rows/columns of a matrix"
  },
  {
    "objectID": "lecture_2_using_r.html#code-is-communication",
    "href": "lecture_2_using_r.html#code-is-communication",
    "title": "Using R",
    "section": "Code is communication",
    "text": "Code is communication\n\nWith your computer\nWith your collaborators\n\n\n“Your closest collaborator is you six months ago but you don’t reply to email.” — Paul Wilson\n\n\nWith reviewers/examiners\n\nNeed understandable code\nGoodstylemakescodeeasiertoread"
  },
  {
    "objectID": "lecture_2_using_r.html#tidy-code",
    "href": "lecture_2_using_r.html#tidy-code",
    "title": "Using R",
    "section": "Tidy code",
    "text": "Tidy code\n\n\nThe only way to write good code is to write tons of shitty code first. Feeling shame about bad code stops you from getting to good code\n\n— Hadley Wickham (@hadleywickham) 17 April 2015\n\n\n\nMakes code easier to read\nMakes code easier to debug\n\nMake your own style - but be consistent\nTidyverse style guide"
  },
  {
    "objectID": "lecture_2_using_r.html#naming-things",
    "href": "lecture_2_using_r.html#naming-things",
    "title": "Using R",
    "section": "Naming Things",
    "text": "Naming Things\n\n“There are only two hard things in Computer Science: cache invalidation and naming things.”\n\n\n— Phil Karlton\n\n\nNames can contain letters, numbers, “_” and “.”\nNames must begin with a letter or “.”\nAvoid using names of existing functions - confusing\nMake names concise yet meaningful\nReserved words include TRUE, for, if"
  },
  {
    "objectID": "lecture_2_using_r.html#which-of-these-are-valid-names-in-r",
    "href": "lecture_2_using_r.html#which-of-these-are-valid-names-in-r",
    "title": "Using R",
    "section": "Which of these are valid names in R",
    "text": "Which of these are valid names in R\n\nmin_height\nmax.height\n_age\n.mass\nMaxLength\nmin-length\nFALSE\ntrue\n2widths\ncelsius2kelvin\nplot\nT"
  },
  {
    "objectID": "lecture_2_using_r.html#names-can-be-too-long",
    "href": "lecture_2_using_r.html#names-can-be-too-long",
    "title": "Using R",
    "section": "Names can be too long",
    "text": "Names can be too long\n\n\n“The church of St. Mary of the pool of the white hazels near to the fierce whirlpool and the church of St. Tysilio of the red cave”\n\n\nRob Koster - CC BY-SA 3.0"
  },
  {
    "objectID": "lecture_2_using_r.html#or-too-short",
    "href": "lecture_2_using_r.html#or-too-short",
    "title": "Using R",
    "section": "Or too short",
    "text": "Or too short\n\nno\n\n\nCommon in old FORTRAN code - save memory with short names exceptions\n\ncounter in a for loop\nmain object in a function"
  },
  {
    "objectID": "lecture_2_using_r.html#naming-convensions",
    "href": "lecture_2_using_r.html#naming-convensions",
    "title": "Using R",
    "section": "Naming convensions",
    "text": "Naming convensions\n\n\n\ncamelCase 🐫\nUpperCamelCase\nsnake_case 🐍\n\n\n\n\nbillLengthMM\nBillLengthMM\nbill_length_mm\n\n\nbergenWeather2022\nBergenWeather2022\nbergen_weather_2022\n\n\ndryMassG\nDryMassG\ndry_mass_g\n\n\nmakeWeatherPlot\nMakeWeatherPlot\nmake_weather_plot"
  },
  {
    "objectID": "lecture_2_using_r.html#white-space-is-free",
    "href": "lecture_2_using_r.html#white-space-is-free",
    "title": "Using R",
    "section": "White-space is free!",
    "text": "White-space is free!\nPlace spaces\n\naround infix operators (|&gt;, +, -, &lt;-, )\naround = in function calls\nafter commas not before\n\nGood\n\ngentoo &lt;- filter(penguins, species == \"Gentoo\", body_mass_g &gt;= 300)\n\nBad\n\ngentoo&lt;-filter(penguins,species==\"Gentoo\",body_mass_g&gt;=300)"
  },
  {
    "objectID": "lecture_2_using_r.html#split-long-commands-over-multiple-lines",
    "href": "lecture_2_using_r.html#split-long-commands-over-multiple-lines",
    "title": "Using R",
    "section": "Split long commands over multiple lines",
    "text": "Split long commands over multiple lines\n\npenguins |&gt; \n  group_by(species) |&gt; \n  summarise(\n    max_mass = max(body_mass_g),\n    mean_bill_length = mean(bill_length_mm),\n   .groups = \"drop\"\n  )\n\n\nAim for a maximum line length of 80 characters"
  },
  {
    "objectID": "lecture_2_using_r.html#indentation-makes-code-more-readable",
    "href": "lecture_2_using_r.html#indentation-makes-code-more-readable",
    "title": "Using R",
    "section": "Indentation makes code more readable",
    "text": "Indentation makes code more readable\nGood\n\npositive &lt;- function(x) {\n  if (is.null(dim(x))) {\n    x[x &gt; 0]\n  } else{\n    x[, colSums(x) &gt; 0, drop  = FALSE]\n  }\n}\n\nBad\n\npositive &lt;- function(x){\nif(is.null(dim(x)))\n{x[x &gt;0]} \nelse{\nx[, colSums(x) &gt; 0, drop  = FALSE]\n}}"
  },
  {
    "objectID": "lecture_2_using_r.html#stylers-lintr",
    "href": "lecture_2_using_r.html#stylers-lintr",
    "title": "Using R",
    "section": "Stylers & lintr",
    "text": "Stylers & lintr\nUse styler package to edit code to meet style guide.\nUse lintr package for static code analysis, including style check\n\nDemo Need dev version of styler for quarto files. remotes::install_github(\"r-lib/styler\")"
  },
  {
    "objectID": "lecture_2_using_r.html#comments",
    "href": "lecture_2_using_r.html#comments",
    "title": "Using R",
    "section": "Comments",
    "text": "Comments\nUse # to start comments.\nHelp you and others to understand what you did\nComments should explain the why, not the what.\nTry to make code self-documenting with descriptive object names\nUse comments for navigation\n\n#### Load data ####\n...\n\n#### Plot data ####\n..."
  },
  {
    "objectID": "lecture_2_using_r.html#no-magic-numbers",
    "href": "lecture_2_using_r.html#no-magic-numbers",
    "title": "Using R",
    "section": "No magic numbers",
    "text": "No magic numbers\n\nx &lt;- c(1, 5, 6, 3, 6)\nmean(x)\n\n[1] 4.2\n\nx[x &gt; 4.2]\n\n[1] 5 6 6\n\n\n\n\nx &lt;- c(1, 5, 6, 3, 6)\nx_mean &lt;- mean(x)\nx[x &gt; x_mean]\n\n[1] 5 6 6"
  },
  {
    "objectID": "lecture_2_using_r.html#split-analyses-over-multiple-files",
    "href": "lecture_2_using_r.html#split-analyses-over-multiple-files",
    "title": "Using R",
    "section": "Split analyses over multiple files",
    "text": "Split analyses over multiple files\nLong scripts become difficult to navigate\nFix by moving parts of the code into different files\nFor example:\n\ndata import code to “loadData.R”\nfunctions to “functions.R”\n\nImport with\n\nsource(\"loadData.R\")\nsource(\"functions.R\")"
  },
  {
    "objectID": "lecture_2_using_r.html#dont-repeat-yourself",
    "href": "lecture_2_using_r.html#dont-repeat-yourself",
    "title": "Using R",
    "section": "Don’t repeat yourself",
    "text": "Don’t repeat yourself\nRepeated code is hard to maintain\nMake repeated code into functions.\n\nmy_fun &lt;- function(arg1) {arg1 ^ 2}\nmy_fun(7)\n\nSingle place to maintain"
  },
  {
    "objectID": "lecture_2_using_r.html#encapsulate-code",
    "href": "lecture_2_using_r.html#encapsulate-code",
    "title": "Using R",
    "section": "Encapsulate code",
    "text": "Encapsulate code\n\nmake_figure_one &lt;- function() {\n  ggplot(penguins, aes(x = bill_length_mm)) +\n    geom_histogram()\n}\n\nmake_figure_one()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#data-visualisation",
    "href": "lecture_4_data_visualisation.html#data-visualisation",
    "title": "Data visualisation",
    "section": "Data visualisation",
    "text": "Data visualisation\n\nA picture is worth a thousand words\nTell a story with figures\nAvoid common mistakes\n\n\n“reflect the data, tell a story, and look professional” Wilke"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#ggplot2",
    "href": "lecture_4_data_visualisation.html#ggplot2",
    "title": "Data visualisation",
    "section": "ggplot2",
    "text": "ggplot2\n\none of at three schemes for graphics in R\npart of tidyverse\n\nA system for ‘declaratively’ creating graphics, based on “The Grammar of Graphics”.\nYou provide the data, tell ‘ggplot2’ how to map variables to aesthetics, what graphical primitives to use, it takes care of the details."
  },
  {
    "objectID": "lecture_4_data_visualisation.html#ggplot-in-action",
    "href": "lecture_4_data_visualisation.html#ggplot-in-action",
    "title": "Data visualisation",
    "section": "ggplot in action",
    "text": "ggplot in action\n\nplot &lt;- ggplot(data = penguins,     # Data\n       mapping = aes(               # Aesthetics\n         x = body_mass_g,    \n         y = bill_length_mm, \n         colour = species)) +\n  geom_point() +                    # Geometries\n  scale_colour_brewer(palette = \"Set1\") + # scales\n  labs(x = \"Body mass, g\",          # labels\n       y = \"Bill length mm\", \n       colour = \"Species\") +\n  theme_bw()                        # themes\n                                    # Also facets\nplot"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#ggplot-in-action-output",
    "href": "lecture_4_data_visualisation.html#ggplot-in-action-output",
    "title": "Data visualisation",
    "section": "ggplot in action",
    "text": "ggplot in action"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#data",
    "href": "lecture_4_data_visualisation.html#data",
    "title": "Data visualisation",
    "section": "Data",
    "text": "Data\nTibble or data frame with data to be plotted.\nTidy data\nCan process data within ggplot but usually best to do it first\nCan add data to the whole plot or to individual geoms\n\npenguin_summary &lt;- penguins |&gt; group_by(species) |&gt; summarise(body_mass_g = mean(body_mass_g, na.rm = TRUE), bill_length_mm = mean(bill_length_mm, na.rm = TRUE) )\nggplot(penguins, aes(x = body_mass_g, y = bill_length_mm, colour = species)) +\n  geom_point() +\n  geom_text(aes(label = species), data = penguin_summary, colour = \"black\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#aesthetics",
    "href": "lecture_4_data_visualisation.html#aesthetics",
    "title": "Data visualisation",
    "section": "Aesthetics",
    "text": "Aesthetics\nmapping specifies which variables in the data should be mapped onto which aesthetics with aes()\nEach geom takes different aesthetics\nCommon aesthetics\n\nx, y\nfill, colour\nshape\nlinetype\ngroup"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#setting-vs-mapping",
    "href": "lecture_4_data_visualisation.html#setting-vs-mapping",
    "title": "Data visualisation",
    "section": "Setting vs mapping",
    "text": "Setting vs mapping\n\n\nMapping in aes()\n\nggplot(penguins, \n       aes(x = flipper_length_mm, \n           fill = \"blue\")) +\ngeom_histogram()\n\n\n\n\n\nSetting in the geom\n\nggplot(penguins, \n       aes(x = flipper_length_mm)) +\ngeom_histogram(fill = \"blue\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#geoms",
    "href": "lecture_4_data_visualisation.html#geoms",
    "title": "Data visualisation",
    "section": "geoms",
    "text": "geoms\nUse different geoms for different plot types\nImportant geoms\n\ngeom_point()\ngeom_boxplot()\ngeom_histogram()\ngeom_smooth()\ngeom_line()\ngeom_text()\n\nMany geoms, some in extra packages"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#geoms-to-show-distributions",
    "href": "lecture_4_data_visualisation.html#geoms-to-show-distributions",
    "title": "Data visualisation",
    "section": "Geoms to show distributions",
    "text": "Geoms to show distributions\n\nbase &lt;- ggplot(penguins, aes(x = flipper_length_mm))\nhist &lt;- base + geom_histogram()\ndens &lt;- base + geom_density()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#geoms-to-show-many-distributions",
    "href": "lecture_4_data_visualisation.html#geoms-to-show-many-distributions",
    "title": "Data visualisation",
    "section": "Geoms to show many distributions",
    "text": "Geoms to show many distributions\n\nbase &lt;- ggplot(penguins, aes(x = species, y = flipper_length_mm))\n\np_prange &lt;- base + stat_summary(fun = \"mean\", geom = \"col\")\np_box &lt;- base + geom_boxplot(aes(fill = species))\np_vio &lt;- base + geom_violin(aes(fill = species))\np_jit &lt;- base + geom_jitter(aes(colour = species))\nlibrary(ggbeeswarm)\np_quasi &lt;- base + geom_quasirandom(aes(colour = species))"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#boxplots-can-mislead",
    "href": "lecture_4_data_visualisation.html#boxplots-can-mislead",
    "title": "Data visualisation",
    "section": "Boxplots can mislead",
    "text": "Boxplots can mislead\n\np &lt;- datasauRus::box_plots |&gt; \n  pivot_longer(everything()) |&gt; \n  ggplot(aes(x = name, y = value))\n\np + geom_boxplot() +\np + geom_violin()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#show-the-raw-data",
    "href": "lecture_4_data_visualisation.html#show-the-raw-data",
    "title": "Data visualisation",
    "section": "Show the raw data",
    "text": "Show the raw data\n\n\n\n\n\n\n\nZhang et al (2023)"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#geoms-for-scatterplots",
    "href": "lecture_4_data_visualisation.html#geoms-for-scatterplots",
    "title": "Data visualisation",
    "section": "geoms for scatterplots",
    "text": "geoms for scatterplots\n\nggplot(penguins, aes(x = body_mass_g,  y = bill_length_mm, colour = species)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#scales",
    "href": "lecture_4_data_visualisation.html#scales",
    "title": "Data visualisation",
    "section": "Scales",
    "text": "Scales\nControl how\n\nvariables are mapped onto the aesthetics\naxes breaks\n\nAll called scale_aesthetic_description\n\nscale_x_log()\nscale_y_reverse()\nscale_colour_viridis_c()\nscale_shape_manual()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#labels",
    "href": "lecture_4_data_visualisation.html#labels",
    "title": "Data visualisation",
    "section": "Labels",
    "text": "Labels\n\nplot, axis and legend titles\n\n\nggplot(penguins, aes(x = body_mass_g, y = bill_length_mm, colour = species)) +\n  geom_point() +\n  labs(x = \"Body mass g\",\n       y = \"Bill length mm\", \n       colour = \"Species\", \n       title = \"Bill length against body mass \")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#facets",
    "href": "lecture_4_data_visualisation.html#facets",
    "title": "Data visualisation",
    "section": "Facets",
    "text": "Facets\nSplit data into separate panels.\n\nplot + facet_wrap(facets = vars(species))"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#themes",
    "href": "lecture_4_data_visualisation.html#themes",
    "title": "Data visualisation",
    "section": "Themes",
    "text": "Themes\nChange how non-data elements of the plot look\nEntire themes"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#themes-1",
    "href": "lecture_4_data_visualisation.html#themes-1",
    "title": "Data visualisation",
    "section": "Themes",
    "text": "Themes\nCan also change individual elements\n\nplot + theme(legend.position = \"top\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#removing-elements",
    "href": "lecture_4_data_visualisation.html#removing-elements",
    "title": "Data visualisation",
    "section": "Removing elements",
    "text": "Removing elements\n\nplot + theme(panel.grid = element_blank())"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#colour-fills",
    "href": "lecture_4_data_visualisation.html#colour-fills",
    "title": "Data visualisation",
    "section": "Colour & fills",
    "text": "Colour & fills"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#colour-deficient-vision",
    "href": "lecture_4_data_visualisation.html#colour-deficient-vision",
    "title": "Data visualisation",
    "section": "Colour deficient vision",
    "text": "Colour deficient vision\n\nden &lt;- ggplot(penguins, aes(x = bill_length_mm, fill = species)) +\n  geom_density(alpha = 0.7)\nden"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#end-rainbow",
    "href": "lecture_4_data_visualisation.html#end-rainbow",
    "title": "Data visualisation",
    "section": "#End rainbow",
    "text": "#End rainbow"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#better-colour-scale",
    "href": "lecture_4_data_visualisation.html#better-colour-scale",
    "title": "Data visualisation",
    "section": "Better colour scale",
    "text": "Better colour scale\n\nden &lt;- ggplot(penguins, aes(x = bill_length_mm, fill = species)) +\n  geom_density(alpha = 0.7) +\n  scale_fill_brewer(palette = \"Set1\")\nden"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#using-colour-effectively",
    "href": "lecture_4_data_visualisation.html#using-colour-effectively",
    "title": "Data visualisation",
    "section": "Using colour effectively",
    "text": "Using colour effectively\nChoose an appropriate palette.\nQualitative palettes\n\nRColorBrewer::display.brewer.all(type = \"qual\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#viridis",
    "href": "lecture_4_data_visualisation.html#viridis",
    "title": "Data visualisation",
    "section": "Viridis",
    "text": "Viridis\n\nggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) +\n  geom_point(aes(colour = flipper_length_mm)) +\n  scale_colour_viridis_c()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#highlight",
    "href": "lecture_4_data_visualisation.html#highlight",
    "title": "Data visualisation",
    "section": "Highlight",
    "text": "Highlight\n\nggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) +\n  geom_point(colour = \"red\") +\n  gghighlight::gghighlight(species == \"Chinstrap\")"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#redundant-encoding",
    "href": "lecture_4_data_visualisation.html#redundant-encoding",
    "title": "Data visualisation",
    "section": "Redundant encoding",
    "text": "Redundant encoding\n\nggplot(penguins, \n       aes(x = body_mass_g,\n           y = flipper_length_mm,\n           colour = species,\n           shape = species)) +\n  geom_point()"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#avoiding-legends",
    "href": "lecture_4_data_visualisation.html#avoiding-legends",
    "title": "Data visualisation",
    "section": "Avoiding legends",
    "text": "Avoiding legends\n\nlibrary(directlabels)\ndirect.label(plot)"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#most-common-mistake-in-presentations",
    "href": "lecture_4_data_visualisation.html#most-common-mistake-in-presentations",
    "title": "Data visualisation",
    "section": "Most common mistake in presentations",
    "text": "Most common mistake in presentations\n\n\n\nSolution\n\ntheme_bw(base_size = 18)"
  },
  {
    "objectID": "lecture_4_data_visualisation.html#summary",
    "href": "lecture_4_data_visualisation.html#summary",
    "title": "Data visualisation",
    "section": "Summary",
    "text": "Summary\n\nYou can plot anything you can imagine\nWhole ecosystem of packages to help\n#tidytuesday for inspiration"
  },
  {
    "objectID": "lecture_6_descriptive.html#describing-a-distribution",
    "href": "lecture_6_descriptive.html#describing-a-distribution",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Describing a distribution",
    "text": "Describing a distribution"
  },
  {
    "objectID": "lecture_6_descriptive.html#midpoint",
    "href": "lecture_6_descriptive.html#midpoint",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Midpoint",
    "text": "Midpoint"
  },
  {
    "objectID": "lecture_6_descriptive.html#mean",
    "href": "lecture_6_descriptive.html#mean",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Mean",
    "text": "Mean\n\n\n\n\n\n\n\n\n\\[\\overline{x} = \\frac{\\sum_{i=1}^n x_i}{n}\\]\n\nSum of all observations divided by number of observations\nCentre of gravity of the data\nmean()"
  },
  {
    "objectID": "lecture_6_descriptive.html#median",
    "href": "lecture_6_descriptive.html#median",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Median",
    "text": "Median\n\n\nSort from minimum to maximum\nObservation in the middle is the median\nmedian()"
  },
  {
    "objectID": "lecture_6_descriptive.html#mean-vs-median",
    "href": "lecture_6_descriptive.html#mean-vs-median",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Mean vs Median",
    "text": "Mean vs Median"
  },
  {
    "objectID": "lecture_6_descriptive.html#mean-vs-median-1",
    "href": "lecture_6_descriptive.html#mean-vs-median-1",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Mean vs Median",
    "text": "Mean vs Median"
  },
  {
    "objectID": "lecture_6_descriptive.html#calculating-mean-and-median-in-r",
    "href": "lecture_6_descriptive.html#calculating-mean-and-median-in-r",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Calculating Mean and Median in R",
    "text": "Calculating Mean and Median in R\n\nvec &lt;- c(56.7, 57.2, 62.7, 56.4, 60.8)\n# mean of a vector\nmean(vec)\n\n[1] 58.76\n\n# median of a vector\nmedian(vec)\n\n[1] 57.2"
  },
  {
    "objectID": "lecture_6_descriptive.html#spread",
    "href": "lecture_6_descriptive.html#spread",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Spread",
    "text": "Spread"
  },
  {
    "objectID": "lecture_6_descriptive.html#minimum-maximum-and-range",
    "href": "lecture_6_descriptive.html#minimum-maximum-and-range",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Minimum, maximum and range",
    "text": "Minimum, maximum and range\n\nmin()\nmax()\n\nRange is difference between smallest and largest.\n\n# range() gives smallest and largest values\nrange(penguins$bill_length_mm, na.rm = TRUE)\n\n[1] 32.1 59.6\n\n# calculate range as\nmax(penguins$bill_length_mm, na.rm = TRUE) - \nmin(penguins$bill_length_mm, na.rm = TRUE)\n\n[1] 27.5\n\n# or\ndiff(range(penguins$bill_length_mm, na.rm = TRUE))\n\n[1] 27.5"
  },
  {
    "objectID": "lecture_6_descriptive.html#variance",
    "href": "lecture_6_descriptive.html#variance",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Variance",
    "text": "Variance\nThe average squared distance around the mean var()\nPopulation variance\n\\[\\sigma^2 = \\frac{\\sum_{i=1}^n (x_i - \\mu)^2}{n}\\] Where \\(\\mu\\) is the population mean.\nSample variance\n\\[s^2 = \\frac{\\sum_{i=1}^n (x_i - \\overline{x})^2}{n-1}\\] Where \\(\\overline{x}\\) is the sample mean."
  },
  {
    "objectID": "lecture_6_descriptive.html#standard-deviation",
    "href": "lecture_6_descriptive.html#standard-deviation",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Standard deviation",
    "text": "Standard deviation\n\n\nSquare root of the variance \\[s = \\sqrt{s^2}\\] \\[s  = \\sqrt{\\frac{\\sum_{i=1}^n (x_i - \\overline{x})^2}{n-1}}\\] Same units as variable\nsqrt(var())\nsd()"
  },
  {
    "objectID": "lecture_6_descriptive.html#skew",
    "href": "lecture_6_descriptive.html#skew",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Skew",
    "text": "Skew\n\n\n\n\n\n\n\n\nRight skew\npositive skew e1071::skewness()"
  },
  {
    "objectID": "lecture_6_descriptive.html#kurtosis",
    "href": "lecture_6_descriptive.html#kurtosis",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Kurtosis",
    "text": "Kurtosis\n\nheavy tails\ne1071::kurtosis()"
  },
  {
    "objectID": "lecture_6_descriptive.html#making-inferences-about-the-population",
    "href": "lecture_6_descriptive.html#making-inferences-about-the-population",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Making inferences about the population",
    "text": "Making inferences about the population\nSample: 123 Gentoo penguins\nPopulation: All Gentoo penguins in the Palmer Archipelago.\nWhat can we infer about the population from the sample?"
  },
  {
    "objectID": "lecture_6_descriptive.html#uncertainty-in-the-mean",
    "href": "lecture_6_descriptive.html#uncertainty-in-the-mean",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Uncertainty in the mean",
    "text": "Uncertainty in the mean\n\nPopulation of 1,000,000 indviduals\nLarge (100 individuals) or small (20 individuals) samples"
  },
  {
    "objectID": "lecture_6_descriptive.html#standard-error-of-the-mean",
    "href": "lecture_6_descriptive.html#standard-error-of-the-mean",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Standard error of the mean",
    "text": "Standard error of the mean\nStandard deviation divided by square root of number of observations\n\\[SE = \\frac{s}{\\sqrt{n}}\\] Large n - small SE - reliable estimate of mean\nSmall n - large SE - less reliable estimate of mean"
  },
  {
    "objectID": "lecture_6_descriptive.html#confidence-interval",
    "href": "lecture_6_descriptive.html#confidence-interval",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Confidence interval",
    "text": "Confidence interval\nIf experiment repeated many times, confidence level represents the proportion of confidence intervals that contain the true value of the unknown population parameter.\nSo 95% confidence interval will contain true value in 95% of repeat experiments\nEasily misunderstood.\n(Bayesian credibility intervals are much more intuitive)"
  },
  {
    "objectID": "lecture_6_descriptive.html#confidence-interval-of-the-mean",
    "href": "lecture_6_descriptive.html#confidence-interval-of-the-mean",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Confidence interval of the mean",
    "text": "Confidence interval of the mean\n95% confidence interval\nMean \\(\\pm\\) 1.96 * SE\nWhy 1.96?\n\nGrey area is 95% of the normal distribution"
  },
  {
    "objectID": "lecture_6_descriptive.html#choosing-a-statistical-test",
    "href": "lecture_6_descriptive.html#choosing-a-statistical-test",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Choosing a statistical test",
    "text": "Choosing a statistical test\n\nWhat is the hypothesis?\n\nWhat is the underlying distribution of your response variable?\n\nWhat type of the predictor(s)?\n\nWhat type of observational or experimental design do you have?"
  },
  {
    "objectID": "lecture_6_descriptive.html#the-hypothesis",
    "href": "lecture_6_descriptive.html#the-hypothesis",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "The hypothesis",
    "text": "The hypothesis\nThe statistical hypothesis needs to match your scientific hypothesis\nHypothesis example:\nH0: The bill length of Gentoo penguins does not depend on sex."
  },
  {
    "objectID": "lecture_6_descriptive.html#the-predictors",
    "href": "lecture_6_descriptive.html#the-predictors",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "The predictors",
    "text": "The predictors\n\nCategorical (sex, species)\nContinuous (body mass)\nboth (with &gt; 1 predictor)\n\nNeed to know so we can code predictor variables and interpret the output of our models."
  },
  {
    "objectID": "lecture_6_descriptive.html#the-response",
    "href": "lecture_6_descriptive.html#the-response",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "The response",
    "text": "The response\n\nContinuous (bill length)\ncount (number of penguins)\nbinary (sex, survived/died)\nproportion (8 out of 10)\n\nStatistical model families (lm, lme, glm etc.) differ in assumptions about the underlying distribution of the response variable."
  },
  {
    "objectID": "lecture_6_descriptive.html#gaussian-normal-distribution",
    "href": "lecture_6_descriptive.html#gaussian-normal-distribution",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Gaussian (Normal) distribution",
    "text": "Gaussian (Normal) distribution\nOften assumed for continuous distributions, body mass, egg shell thickness"
  },
  {
    "objectID": "lecture_6_descriptive.html#poisson-distribution",
    "href": "lecture_6_descriptive.html#poisson-distribution",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Poisson distribution",
    "text": "Poisson distribution\nCount data\nShape varies with mean"
  },
  {
    "objectID": "lecture_6_descriptive.html#experimental-design",
    "href": "lecture_6_descriptive.html#experimental-design",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Experimental design",
    "text": "Experimental design\n\nIndependent observations?\ntime series?\nclustered design?"
  },
  {
    "objectID": "lecture_6_descriptive.html#key",
    "href": "lecture_6_descriptive.html#key",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Key",
    "text": "Key\n\nIndependent observations\n\nContinuous response = linear models (lm(), t.test())\nCount/binary/proportion = generalised linear models (glm())\n\nClustered observations\n\nContinuous response = linear mixed effect models (lme(), lmer())\nCount/binary/proportion = generalised linear mixed effect models (glmer())"
  },
  {
    "objectID": "lecture_6_descriptive.html#a-t-test",
    "href": "lecture_6_descriptive.html#a-t-test",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "A t-test",
    "text": "A t-test\nCompare means\nH0: Bill length does not depend on sex in Gentoo penguins"
  },
  {
    "objectID": "lecture_6_descriptive.html#t-test-in-r",
    "href": "lecture_6_descriptive.html#t-test-in-r",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "t-test in R",
    "text": "t-test in R\n\ngentoo &lt;- penguins |&gt; \n  filter(species == \"Gentoo\")|&gt; \n  drop_na(bill_length_mm, sex)\n\nmod1 &lt;- t.test(bill_length_mm ~ sex, data = gentoo)"
  },
  {
    "objectID": "lecture_6_descriptive.html#p-values",
    "href": "lecture_6_descriptive.html#p-values",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "P values",
    "text": "P values\nOften misinterpreted\n\nNot a measure of effect size or practical significance\nNot the probability that hypothesis is true\nStrongly affected by sample size\n\nIf there were actually no effect (if the true difference between means were zero) then the probability of observing a value for the difference equal to, or greater than, that actually observed would be p=0.05.\nMany assumptions\nConfidence intervals are more interpretable"
  },
  {
    "objectID": "lecture_6_descriptive.html#type-1-and-type-2-errors",
    "href": "lecture_6_descriptive.html#type-1-and-type-2-errors",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Type 1 and type 2 errors",
    "text": "Type 1 and type 2 errors\n\n\n\n\n\n\n\n\n\n\n\n\n\nNull hypothesis is\nTrue\nFalse\n\n\n\n\n\nRejected\n\n\nType I error\nFalse positive\n\n\nCorrect decision\nTrue positive\n\n\n\n\nNot rejected\n\n\nCorrect decision\nTrue negative\n\n\nType II error\nFalse negative"
  },
  {
    "objectID": "lecture_6_descriptive.html#one-sided-z-test",
    "href": "lecture_6_descriptive.html#one-sided-z-test",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "One sided Z-test",
    "text": "One sided Z-test"
  },
  {
    "objectID": "lecture_6_descriptive.html#the-need-for-power",
    "href": "lecture_6_descriptive.html#the-need-for-power",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "The need for power",
    "text": "The need for power\nWith little power:\n\nMay not be able to reject H0 when it is false\nExaggerate effect size\n\nLots of power\n\nProbably can reject H0 when it is false\nMore precise estimates of effect size\nMore expensive\n\nNeed to do power analysis before experiment."
  },
  {
    "objectID": "lecture_6_descriptive.html#components-of-a-power-analysis",
    "href": "lecture_6_descriptive.html#components-of-a-power-analysis",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Components of a power analysis",
    "text": "Components of a power analysis\n\nEffect size\nType I error rate (significance level - conventionally set to 0.05)\nType II error rate (conventionally aim for 0.8)\nNumber of observations\n\nCan solve for any of these\nTypically want to know how many observations needed."
  },
  {
    "objectID": "lecture_6_descriptive.html#analytic-power-analysis",
    "href": "lecture_6_descriptive.html#analytic-power-analysis",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Analytic power analysis",
    "text": "Analytic power analysis\nSome power tests in base R.\n\npower.t.test\npower.anova.test\npower.prop.test\n\nMore in pwr package"
  },
  {
    "objectID": "lecture_6_descriptive.html#power-t-test",
    "href": "lecture_6_descriptive.html#power-t-test",
    "title": "Descriptive statistics and Introduction to statistical inference",
    "section": "Power t test",
    "text": "Power t test\n\nlibrary(\"pwr\")\npow &lt;- pwr.t.test(d = 0.5, sig.level = 0.05, power = 0.8)\npow\n\n\n     Two-sample t test power calculation \n\n              n = 63.76561\n              d = 0.5\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n\n\nEffect size is Cohen’s d \\(d = \\frac{\\mu_1 - \\mu_2}{\\sigma}\\)"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#outline",
    "href": "lecture_8_multiple_regression.html#outline",
    "title": "Multiple Regression",
    "section": "Outline",
    "text": "Outline\n\nTypes of models\nInteractions\nModel selection\n\nExploratory data analysis\nAnova for hypothesis testing\n\nMulti-collinearity"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#adding-more-variables",
    "href": "lecture_8_multiple_regression.html#adding-more-variables",
    "title": "Multiple Regression",
    "section": "Adding more variables",
    "text": "Adding more variables\n\n# Two way anova - two categorical predictors\nmod_anova2 &lt;- lm(bill_length_mm ~ sex + species, data = penguins)\n\n# ancova - one categorical one continuous predictor\nmod_ancova &lt;- lm(bill_length_mm ~ sex + flipper_length_mm, data = penguins)\n\n# Multiple regression - two continuous\nmod_mult &lt;- lm(bill_length_mm ~ body_mass_g + flipper_length_mm, data = penguins)"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#different-formula",
    "href": "lecture_8_multiple_regression.html#different-formula",
    "title": "Multiple Regression",
    "section": "Different formula",
    "text": "Different formula"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#what-is-an-interaction",
    "href": "lecture_8_multiple_regression.html#what-is-an-interaction",
    "title": "Multiple Regression",
    "section": "What is an interaction",
    "text": "What is an interaction\nEffect of one predictor depends on value of another"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#interaction-between-categorical-predictors",
    "href": "lecture_8_multiple_regression.html#interaction-between-categorical-predictors",
    "title": "Multiple Regression",
    "section": "Interaction between categorical predictors",
    "text": "Interaction between categorical predictors\n\n\n\nmod &lt;- lm(flipper_length_mm ~ species * sex, data = penguins)\nsummary(mod)\n\n\nCall:\nlm(formula = flipper_length_mm ~ species * sex, data = penguins)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.795  -3.411   0.088   3.459  17.589 \n\nCoefficients:\n                         Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)               187.795      0.662  283.72  &lt; 2e-16 ***\nspeciesChinstrap            3.941      1.174    3.36  0.00088 ***\nspeciesGentoo              24.912      0.995   25.04  &lt; 2e-16 ***\nsexmale                     4.616      0.936    4.93  1.3e-06 ***\nspeciesChinstrap:sexmale    3.560      1.661    2.14  0.03278 *  \nspeciesGentoo:sexmale       4.218      1.397    3.02  0.00274 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.66 on 327 degrees of freedom\n  (11 observations deleted due to missingness)\nMultiple R-squared:  0.84,  Adjusted R-squared:  0.837 \nF-statistic:  342 on 5 and 327 DF,  p-value: &lt;2e-16"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#interaction-between-continuous-and-categorical-predictors",
    "href": "lecture_8_multiple_regression.html#interaction-between-continuous-and-categorical-predictors",
    "title": "Multiple Regression",
    "section": "Interaction between continuous and categorical predictors",
    "text": "Interaction between continuous and categorical predictors"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#interaction-between-two-continuous-predictors",
    "href": "lecture_8_multiple_regression.html#interaction-between-two-continuous-predictors",
    "title": "Multiple Regression",
    "section": "Interaction between two continuous predictors",
    "text": "Interaction between two continuous predictors"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#power-needed-for-interactions",
    "href": "lecture_8_multiple_regression.html#power-needed-for-interactions",
    "title": "Multiple Regression",
    "section": "Power needed for interactions",
    "text": "Power needed for interactions\n\nMain effect = ybar1 - ybar2\nInteraction = (ybar1 - ybar2) - (ybar3 - ybar4)"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#formula-for-interactions",
    "href": "lecture_8_multiple_regression.html#formula-for-interactions",
    "title": "Multiple Regression",
    "section": "Formula for interactions",
    "text": "Formula for interactions\ny ~ x + z + x:z\ny ~ x * z\ny ~ (x + z)^2\nUse y ~ x + I(x^2) to get a quadratic. Or y ~ poly(x, 2)"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#model-selection",
    "href": "lecture_8_multiple_regression.html#model-selection",
    "title": "Multiple Regression",
    "section": "Model Selection",
    "text": "Model Selection\nYou want to the best model!\nThe best model for what?\n\nExploratory data analysis\nInference (hypothesis testing)\nPredictions\n\n\n\nTredennick et al 2021 A practical guide to selecting models for exploration, inference, and prediction in ecology Ecology. https://doi.org/10.1002/ecy.3336"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#exploratory-analysis",
    "href": "lecture_8_multiple_regression.html#exploratory-analysis",
    "title": "Multiple Regression",
    "section": "Exploratory analysis",
    "text": "Exploratory analysis\n\nConsider all plausible models\nP-values not meaningful\nHigh type I error rate\nSuggest hypotheses for hypothesis testing with independent data\n\nThe more biology you include in the model"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#automatic-model-selection",
    "href": "lecture_8_multiple_regression.html#automatic-model-selection",
    "title": "Multiple Regression",
    "section": "Automatic model selection",
    "text": "Automatic model selection\nLast resort - many problems and biases\nForward selection\nBackwards selection\nAll possible models"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#aic",
    "href": "lecture_8_multiple_regression.html#aic",
    "title": "Multiple Regression",
    "section": "AIC",
    "text": "AIC\nAIC Akaike information criterion \\(2k - 2 \\times log(likelihood)\\)\n(k the number of parameters)\nMeasure of how well the model fit the data\nPenalised for model complexity\nAICc correction for small sample sizes\nAIC weights - probability model is best of those tested"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#caranova-vs-anova",
    "href": "lecture_8_multiple_regression.html#caranova-vs-anova",
    "title": "Multiple Regression",
    "section": "car::Anova vs anova",
    "text": "car::Anova vs anova\n\nmod2 &lt;- lm(body_mass_g ~ species + sex, data = penguins)\nmod3 &lt;- lm(body_mass_g ~ sex + species, data = penguins)\n\n\nanova - tests terms sequentially\ncar::Anova - marginal test"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#inference",
    "href": "lecture_8_multiple_regression.html#inference",
    "title": "Multiple Regression",
    "section": "Inference",
    "text": "Inference\nTest small number of a priori hypothesis.\nUse anova() to compare nested models\nH0 there is no interaction between sex and species for predicting flipper length\n\nmod1 &lt;- lm(body_mass_g ~ species + sex, data = penguins)\nmod2 &lt;- lm(body_mass_g ~ species * sex, data = penguins)\nanova(mod1, mod2)\n\nAnalysis of Variance Table\n\nModel 1: body_mass_g ~ species + sex\nModel 2: body_mass_g ~ species * sex\n  Res.Df      RSS Df Sum of Sq    F Pr(&gt;F)    \n1    329 32979185                             \n2    327 31302628  2   1676557 8.76  2e-04 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "lecture_8_multiple_regression.html#multicollinearity",
    "href": "lecture_8_multiple_regression.html#multicollinearity",
    "title": "Multiple Regression",
    "section": "Multicollinearity",
    "text": "Multicollinearity\n\nTwo or more predictor variables in a multiple regression model are highly correlated. Example: pH and calcium\nCoefficient estimates may change erratically in response to small changes in the model or the data.\nSolve by having lots of data"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#assumptions-of-least-squares",
    "href": "lecture_10_mixed_effect_models.html#assumptions-of-least-squares",
    "title": "Mixed effect Models",
    "section": "Assumptions of Least Squares",
    "text": "Assumptions of Least Squares\n\nLinear relationship between response and predictors.\nThe residuals have a mean of zero.\nThe residuals have constant variance (not heteroscedastic).\nThe residuals are independent (uncorrelated).\nThe residuals are normally distributed.\n\n\nSpatial/temporal/phylogenetic autocorrelation\nClustered/hierarchical data"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#clustered-data",
    "href": "lecture_10_mixed_effect_models.html#clustered-data",
    "title": "Mixed effect Models",
    "section": "Clustered data",
    "text": "Clustered data\nObservations not independent\n\nclustered data\nrepeat measurements\n\nIgnoring it causes pseudoreplication\n\n\nWorldFish"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#two-tanks---bad-design",
    "href": "lecture_10_mixed_effect_models.html#two-tanks---bad-design",
    "title": "Mixed effect Models",
    "section": "Two tanks - bad design",
    "text": "Two tanks - bad design"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#two-tanks---bad-models",
    "href": "lecture_10_mixed_effect_models.html#two-tanks---bad-models",
    "title": "Mixed effect Models",
    "section": "Two tanks - bad models",
    "text": "Two tanks - bad models\n\nmod_bad &lt;- lm(Mass_g ~ condition, data = demo)\nmod_bad2 &lt;- lm(Mass_g ~ tank, data = demo)\n\nmod_bad\n\n\nCall:\nlm(formula = Mass_g ~ condition, data = demo)\n\nCoefficients:\n  (Intercept)  conditiontest  \n       1147.6         -105.1  \n\nmod_bad2\n\n\nCall:\nlm(formula = Mass_g ~ tank, data = demo)\n\nCoefficients:\n(Intercept)       tankt2  \n     1147.6       -105.1"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#better-design---replicate-tanks",
    "href": "lecture_10_mixed_effect_models.html#better-design---replicate-tanks",
    "title": "Mixed effect Models",
    "section": "Better design - replicate tanks",
    "text": "Better design - replicate tanks"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#better-design-bit-better-model",
    "href": "lecture_10_mixed_effect_models.html#better-design-bit-better-model",
    "title": "Mixed effect Models",
    "section": "Better design, bit better model",
    "text": "Better design, bit better model\n\nmod_bit &lt;- lm(Mass_g ~ condition + tank, data = demo2)\nsummary(mod_bit)\n\n\nCall:\nlm(formula = Mass_g ~ condition + tank, data = demo2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-270.11  -59.70   20.80   71.17  224.67 \n\nCoefficients: (1 not defined because of singularities)\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    1202.37      33.38  36.021  &lt; 2e-16 ***\nconditiontest   -68.44      47.21  -1.450 0.151439    \ntankt2         -118.07      47.21  -2.501 0.014654 *  \ntankt3         -195.25      47.21  -4.136 9.44e-05 ***\ntankt4           33.35      47.21   0.707 0.482102    \ntankt5         -178.79      47.21  -3.788 0.000313 ***\ntankt6          -49.47      47.21  -1.048 0.298128    \ntankt7          -96.71      47.21  -2.049 0.044128 *  \ntankt8              NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 105.6 on 72 degrees of freedom\nMultiple R-squared:  0.3187,    Adjusted R-squared:  0.2525 \nF-statistic: 4.812 on 7 and 72 DF,  p-value: 0.0001745"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#fixed-effect-and-random-effects",
    "href": "lecture_10_mixed_effect_models.html#fixed-effect-and-random-effects",
    "title": "Mixed effect Models",
    "section": "Fixed effect and random effects",
    "text": "Fixed effect and random effects\nFixed effect effect model\n\\[y_i = \\color{red}{\\beta_0} + \\color{red}{\\beta_1}x_i + \\color{red}{\\beta_2}tank_i  +\\color{blue}{ \\epsilon_i}\\]\nNot interested in effect of tank\nMixed effect model\nUse a Random effect\nAssumes observed tanks from a population of possible tanks\n\\[y_{ij} = \\color{red}{\\beta_0} +\\color{blue}{b_{0i}}+ \\color{red}{\\beta_1}x_i +\\color{blue}{ \\epsilon_{ij}}\\]"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#random-effects",
    "href": "lecture_10_mixed_effect_models.html#random-effects",
    "title": "Mixed effect Models",
    "section": "Random effects",
    "text": "Random effects\nResiduals from a normal distribution \\(\\color{blue}{ \\epsilon_{ij}} \\sim N(0, \\sigma_{ind})\\)\nRandom effects from a normal distribution \\(\\color{blue}{b_{0i}} \\sim N(0, \\sigma_{clu})\\)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#fitting-a-mixed-effect-model",
    "href": "lecture_10_mixed_effect_models.html#fitting-a-mixed-effect-model",
    "title": "Mixed effect Models",
    "section": "Fitting a mixed effect model",
    "text": "Fitting a mixed effect model\n\nlibrary(lme4)\nmod1 &lt;- lmer(Mass_g ~ condition + (1|tank), data = demo2)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#alternative-package",
    "href": "lecture_10_mixed_effect_models.html#alternative-package",
    "title": "Mixed effect Models",
    "section": "Alternative package",
    "text": "Alternative package\n\nlibrary(nlme)\nmod2 &lt;- lme(Mass_g ~ condition, data = demo2, random =  ~ 1|tank)\nsummary(mod2)\n\nLinear mixed-effects model fit by REML\n  Data: demo2 \n       AIC      BIC    logLik\n  973.8449 983.2717 -482.9225\n\nRandom effects:\n Formula: ~1 | tank\n        (Intercept) Residual\nStdDev:    71.12618  105.555\n\nFixed effects:  Mass_g ~ condition \n                  Value Std.Error DF   t-value p-value\n(Intercept)   1084.6791  39.28460 72 27.610796   0.000\nconditiontest   15.7008  55.55682  6  0.282608   0.787\n Correlation: \n              (Intr)\nconditiontest -0.707\n\nStandardized Within-Group Residuals:\n       Min         Q1        Med         Q3        Max \n-2.6916143 -0.5418500  0.1988656  0.6273686  2.2428518 \n\nNumber of Observations: 80\nNumber of Groups: 8"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#fixed-or-random-effects",
    "href": "lecture_10_mixed_effect_models.html#fixed-or-random-effects",
    "title": "Mixed effect Models",
    "section": "Fixed or random effects",
    "text": "Fixed or random effects\nFixed effects factors:\n\nInformative factor levels with regard to the hypothesis\nEffect of each level interesting\nThe levels are deliberately chosen by experimenter\nIncreasing sample size doesn’t increase number of levels\n\nRandom effects factors:\n\nUninformative factor levels with regard to the hypothesis\nEffect of each level uninteresting\nIncreasing sample size often increases number of levels\nPart of a population of possible levels"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#fixed-or-random-effects-1",
    "href": "lecture_10_mixed_effect_models.html#fixed-or-random-effects-1",
    "title": "Mixed effect Models",
    "section": "Fixed or random effects?",
    "text": "Fixed or random effects?\n\nsnake id number\nvaccinated or not\nspecies\nlight level\nlitter of puppies\nsite"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#outer-and-inner-variables",
    "href": "lecture_10_mixed_effect_models.html#outer-and-inner-variables",
    "title": "Mixed effect Models",
    "section": "Outer and inner variables",
    "text": "Outer and inner variables\n\n\n\n\n\n\n\n\n\nwhich design is more powerful?\nwhich design is practical"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#continuous-inner-predictor",
    "href": "lecture_10_mixed_effect_models.html#continuous-inner-predictor",
    "title": "Mixed effect Models",
    "section": "Continuous inner predictor",
    "text": "Continuous inner predictor\n\ndata(\"sleepstudy\", package = \"lme4\")"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#random-intercept",
    "href": "lecture_10_mixed_effect_models.html#random-intercept",
    "title": "Mixed effect Models",
    "section": "Random intercept",
    "text": "Random intercept\n\nfm1 &lt;- lmer(Reaction ~ Days + (1|Subject), sleepstudy, subset = Days&gt;=2)\n\nsummary(fm1)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: Reaction ~ Days + (1 | Subject)\n   Data: sleepstudy\n Subset: Days &gt;= 2\n\nREML criterion at convergence: 1430\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6261 -0.4450  0.0474  0.5199  4.1378 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Subject  (Intercept) 1746.9   41.80   \n Residual              913.1   30.22   \nNumber of obs: 144, groups:  Subject, 18\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)  245.097     11.829  30.617   20.72   &lt;2e-16 ***\nDays          11.435      1.099 125.000   10.40   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\nDays -0.511"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#random-slope",
    "href": "lecture_10_mixed_effect_models.html#random-slope",
    "title": "Mixed effect Models",
    "section": "Random slope",
    "text": "Random slope\n\nfm2 &lt;- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, subset = Days&gt;=2)\n\nsummary(fm2)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: Reaction ~ Days + (Days | Subject)\n   Data: sleepstudy\n Subset: Days &gt;= 2\n\nREML criterion at convergence: 1404.1\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-4.0157 -0.3541  0.0069  0.4681  5.0732 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n Subject  (Intercept) 992.69   31.507        \n          Days         45.77    6.766   -0.25\n Residual             651.59   25.526        \nNumber of obs: 144, groups:  Subject, 18\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)  245.097      9.260  16.999  26.468 2.95e-15 ***\nDays          11.435      1.845  17.001   6.197 9.74e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\nDays -0.454"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#comparing-models",
    "href": "lecture_10_mixed_effect_models.html#comparing-models",
    "title": "Mixed effect Models",
    "section": "Comparing models",
    "text": "Comparing models\n\nanova(fm1, fm2)\n\nData: sleepstudy\nSubset: Days &gt;= 2\nModels:\nfm1: Reaction ~ Days + (1 | Subject)\nfm2: Reaction ~ Days + (Days | Subject)\n    npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    \nfm1    4 1446.5 1458.4 -719.25   1438.5                         \nfm2    6 1425.2 1443.0 -706.58   1413.2 25.332  2  3.156e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#model-diagnostics",
    "href": "lecture_10_mixed_effect_models.html#model-diagnostics",
    "title": "Mixed effect Models",
    "section": "Model diagnostics",
    "text": "Model diagnostics\nSee ?plot.merMod\n\nfm1F &lt;- augment(fm1)\n## standardized residuals versus fitted values\nggplot(fm1F, aes(x = .fitted, y = .resid)) + \n  geom_point(colour = \"blue\") +\n  geom_hline(yintercept = 0)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#crossed-random-effects",
    "href": "lecture_10_mixed_effect_models.html#crossed-random-effects",
    "title": "Mixed effect Models",
    "section": "Crossed random effects",
    "text": "Crossed random effects\nTwo random effects\nEggs from birds nests (first random effect - lay_nest) moved to other nests (second random effect - hatch_nest)\n\nlmer(mass ~ treatment + (1|lay_nest) + (1|hatch_nest), data = data)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#nested-random-effects",
    "href": "lecture_10_mixed_effect_models.html#nested-random-effects",
    "title": "Mixed effect Models",
    "section": "Nested random effects",
    "text": "Nested random effects\nHierarchical random effects\n\nPlot nested in site\nsample nested in fish nested in tank\nspecies nested in family\n\n\nlmer(mass ~ treatment + (1|site/plot), data = data)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#beyond-linear-mixed-effect-models",
    "href": "lecture_10_mixed_effect_models.html#beyond-linear-mixed-effect-models",
    "title": "Mixed effect Models",
    "section": "Beyond linear mixed effect models",
    "text": "Beyond linear mixed effect models\nGeneralised linear mixed effect models\n\npoisson\nbinomial\n\nFit with glmer()\nAutocorrelated data\n\nrepeat measurements\nfit with nlme::lme()"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#bayesian-hierarchial-models",
    "href": "lecture_10_mixed_effect_models.html#bayesian-hierarchial-models",
    "title": "Mixed effect Models",
    "section": "Bayesian hierarchial models",
    "text": "Bayesian hierarchial models\nMixed effect models can be hard to fit\n\nconvergence problems\n\nBayesian model can help\nDifferent statistical philosophy\n\nrstan\nnimble\n\nUse prior information (or uninformative priors)"
  },
  {
    "objectID": "lecture_10_mixed_effect_models.html#resources",
    "href": "lecture_10_mixed_effect_models.html#resources",
    "title": "Mixed effect Models",
    "section": "Resources",
    "text": "Resources\nBolker B (2021) GLMM FAQ\nHarrison et al (2018) A brief introduction to mixed effects modelling and multi-model inference in ecology"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bio300b Biostatistikk",
    "section": "",
    "text": "These pages host the lecture notes and other resources for Bio300b Biostatistikk, a 5 ETCS credit course at the University of Bergen."
  },
  {
    "objectID": "materials.html",
    "href": "materials.html",
    "title": "Resources",
    "section": "",
    "text": "The biostats team have written a series of books  (“Enough R to write a thesis”), apps, and tutorials that we will use in Bio300B"
  },
  {
    "objectID": "materials.html#biostats-books",
    "href": "materials.html#biostats-books",
    "title": "Resources",
    "section": "Biostats Books",
    "text": "Biostats Books\nThe Biostats books emphasis reproducible research.\n\nWorking in R\n\n\n\n\n\n\n\n\n\n\n\nLearn how to import, manipulate and visualise data with our working in R book. After an introduction to R, this book has a tidyverse flavour, showing how to manipulate data with dplyr and make publishable plots with ggplot2. It includes lots of exercises to hone your skills.\n\n\n\nReproducible documents with R\n\n\n\n\n\n\n\n\n\n\n\nLearn how to write reproducible documents (anything from a course assignment to a thesis or manuscript) in quarto: no more copy-paste nightmares. Quarto is the successor to R markdown."
  },
  {
    "objectID": "materials.html#biostats-apps-and-tutorials",
    "href": "materials.html#biostats-apps-and-tutorials",
    "title": "Resources",
    "section": "Biostats apps and tutorials",
    "text": "Biostats apps and tutorials\nWe have developed interactive learnr tutorials for\n\nnaming objects\ndates and times\nmathematical notation on plots\n\nand shiny apps to explore some statistical concepts.\nThese can be installed from biostats apps and learnr tutorials with\n\n# install remotes if you don't have it already\n# install.packages(\"remotes\")\nremotes::install_github(\"biostats-r/biostats.tutorials\")"
  }
]