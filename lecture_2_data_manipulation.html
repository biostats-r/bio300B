<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data manipulation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Richard J. Telford (Richard.Telford@uib.no)" />
    <meta name="date" content="2021-09-07" />
    <script src="libs/header-attrs-2.10/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data manipulation
## Bio300B Lecture 2
### Richard J. Telford (<a href="mailto:Richard.Telford@uib.no" class="email">Richard.Telford@uib.no</a>)
### Institutt for biovitenskap, UiB
### 07 September 2021

---

&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 24px;
    padding: 1em 4em 1em 4em;
}
&lt;/style&gt;


# Data cleaning

- Critical
- Time consuming 
- Do in code for reproducibility
- Often not taught

&lt;div class="figure"&gt;
&lt;img src="figures/wild_data.jpg" alt="Meme showing cute puppy representing data used in tutorials and a weird dog representing data in the wild."  /&gt;
&lt;p class="caption"&gt;Figure from [towards_AI](https://twitter.com/towards_AI/status/1332567246011555840?s=20)&lt;/p&gt;
&lt;/div&gt;


---
# Tidy data

    Happy families are all alike; every 
    unhappy family is unhappy in its own way    Tolstoy 
    
- Every column is a variable.
- Every row is an observation.
- Every cell is a single value.

&lt;img src="figures/tidy1.png" title="Representation of tidy data, showing variables in columns, observations in rows, and single values in each cell. Source: R for Data Science" alt="Representation of tidy data, showing variables in columns, observations in rows, and single values in each cell. Source: R for Data Science" width="100%" /&gt;

.footnote[[Wickham (2014) Tidy data](https://vita.had.co.nz/papers/tidy-data.pdf)]

---
# Untidy data


|Date     |17.06.2016         |21.06.2016 |23.06.2016   |26.06.2016             |
|:--------|:------------------|:----------|:------------|:----------------------|
|Time     |10:00              |11:00      |11:00        |13:00                  |
|Weather  |Sunny_PartlyCloudy |Cloudy_Fog |Cloudy_Sunny |Cloudy_Rainy_Windy_Fog |
|Observer |LV_AH              |LV         |LV           |LV                     |
|E01a     |0                  |NA         |0            |0                      |
|E01b     |0                  |NA         |0            |0                      |
|E01c     |0                  |NA         |0            |0                      |
|E01d     |0                  |NA         |0            |0                      |
|E01e     |0                  |NA         |0            |0                      |

---
# The heart of your analysis pipeline

<div id="htmlwidget-a14f8a0e4713a8136dde" style="width:504px;height:500px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-a14f8a0e4713a8136dde">{"x":{"diagram":"\n      digraph circo {\n      \n      graph [layout = dot,  rankdir = TB]\n      node [shape = circle, fontsize = 18, style = filled, fillcolor =  orange, fixedsize = FALSE, fontname = \"Palatino\", label = \"\"]\n      a1 [shape = circle, fillcolor = purple]\n      a2 [shape = doubleoctagon, fillcolor = darkgreen]\n      a3 [shape = star]\n      \n      node [shape = egg, fontsize = 18, style = filled, fillcolor =  steelblue1, fixedsize = FALSE, fontname = \"Palatino\"]\n\n      b [label = \"Tidy data\", shape = box]\n      c [label = \"Clean and tidy data\", shape = box]\n\n      d [label = \"Analysis\"]\n      e [label = \"Visualisation\"]\n      \n      {a1, a2, a3}->b->c->{d, e}\n\n      }\n     ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>



---
# Pipes

Analysis:

 - With penguins data
 - Drop rows with NA sex
 - find mean bill length per species per sex

First solution


```r
summarise(
  group_by(drop_na(penguins, sex), species, sex), 
  bill_length_mean = mean(bill_length_mm),
  .groups = "drop")
```

```
## # A tibble: 6 × 3
##   species sex    bill_length_mean
##   &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;
## 1 Adelie  female             37.3
## 2 Adelie  male               40.4
## # … with 4 more rows
```
---
Second solution


```r
p &lt;- drop_na(penguins, sex)
p &lt;- group_by(p, species, sex)
p &lt;- summarise(p,
         bill_length_mean = mean(bill_length_mm),
        .groups = "drop")
```

Third solution


```r
p_1 &lt;- drop_na(penguins, sex)
p_2 &lt;- group_by(p_1, species, sex)
p_3 &lt;- summarise(p_2,
         bill_length_mean = mean(bill_length_mm),
        .groups = "drop")
```

---
# pipe solution


```r
p &lt;- penguins |&gt; 
  drop_na(sex) |&gt; 
  group_by(species, sex) |&gt; 
  summarise(
    bill_length_mean = mean(bill_length_mm),
    .groups = "drop")
```

Pipe puts result of left hand side into first available argument on right hand side

- |&gt; native R pipe (R &gt;= 4.1)
- `%&gt;%` `magrittr` pipe

---
# Reshaping data

Long data vs wide data

&lt;img src="figures/tidyr-pivot_longer_wider.gif" title="Animation showing how pivot_longer converts wide data to long, and pivot_wider does the opposite." alt="Animation showing how pivot_longer converts wide data to long, and pivot_wider does the opposite."  /&gt;


---



Wide data


```r
mites # part of vegan::mite
```

```
##   sample Brachy PHTH HPAV RARD
## 1      1     17    5    5    3
## 2      2      2    7   16    0
## 3      3      4    3    1    1
## 4      4     23    7   10    2
## 5      5      5    8   13    9
```

---
# pivot_longer()


```r
mites_long &lt;- mites |&gt; 
  pivot_longer(cols = Brachy:RARD, 
               names_to = "taxon", 
               values_to = "count")
mites_long
```

```
## # A tibble: 20 × 3
##    sample taxon  count
##     &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
##  1      1 Brachy    17
##  2      1 PHTH       5
##  3      1 HPAV       5
##  4      1 RARD       3
##  5      2 Brachy     2
##  6      2 PHTH       7
##  7      2 HPAV      16
##  8      2 RARD       0
##  9      3 Brachy     4
## 10      3 PHTH       3
## # … with 10 more rows
```

---
# pivot_wider()


```r
mites_wide &lt;- mites_long |&gt; 
  pivot_wider(names_from = "taxon", 
              values_from = "count")
mites_wide
```

```
## # A tibble: 5 × 5
##   sample Brachy  PHTH  HPAV  RARD
##    &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1      1     17     5     5     3
## 2      2      2     7    16     0
## 3      3      4     3     1     1
## 4      4     23     7    10     2
## 5      5      5     8    13     9
```


---
# Key dplyr functions

- `select()`
- `filter()`
- `mutate()`
- `summarise()`
- `group_by()`

---
# Selecting columns  
`dplyr::select()`


```r
penguins |&gt; 
  select(species, bill_length_mm)
```

```
## # A tibble: 344 × 2
##   species bill_length_mm
##   &lt;fct&gt;            &lt;dbl&gt;
## 1 Adelie            39.1
## 2 Adelie            39.5
## # … with 342 more rows
```



```r
penguins |&gt; 
  select(-bill_length_mm, -bill_depth_mm)
```

```
## # A tibble: 344 × 6
##   species island    flipper_length_mm body_mass_g sex     year
##   &lt;fct&gt;   &lt;fct&gt;                 &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
## 1 Adelie  Torgersen               181        3750 male    2007
## 2 Adelie  Torgersen               186        3800 female  2007
## # … with 342 more rows
```

---
# Selecting adjacent columns


```r
penguins |&gt; 
  select(bill_length_mm:body_mass_g)
```

```
## # A tibble: 344 × 4
##   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
## 1           39.1          18.7               181        3750
## 2           39.5          17.4               186        3800
## # … with 342 more rows
```


```r
penguins |&gt; 
  select(-(bill_length_mm:body_mass_g))
```

```
## # A tibble: 344 × 4
##   species island    sex     year
##   &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;
## 1 Adelie  Torgersen male    2007
## 2 Adelie  Torgersen female  2007
## # … with 342 more rows
```


---
# Select helpers

`ends_with()`

```r
penguins |&gt; 
  select(species, ends_with("mm"))
```

```
## # A tibble: 344 × 4
##   species bill_length_mm bill_depth_mm flipper_length_mm
##   &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;
## 1 Adelie            39.1          18.7               181
## 2 Adelie            39.5          17.4               186
## # … with 342 more rows
```
- `starts_with()`
- `contains()`
- `matches()` regular expressions

---
# Filtering rows 
`dplyr::filter()`


```r
penguins |&gt; filter(species == "Gentoo")
```

```
## # A tibble: 124 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Gentoo  Biscoe           46.1          13.2              211        4500 fema…
## 2 Gentoo  Biscoe           50            16.3              230        5700 male 
## # … with 122 more rows, and 1 more variable: year &lt;int&gt;
```

One or more logical statements

- `==`
- `&gt;=`
- `&lt;`
- `!=`

---
# near()

Problem:


```r
sqrt(2) ^ 2 == 2
```

```
## [1] FALSE
```


```r
sqrt(2) ^ 2 - 2
```

```
## [1] 4.440892e-16
```


Solution:


```r
near(sqrt(2) ^ 2, 2)
```

```
## [1] TRUE
```

---
# `%in%`

Problem


```r
penguins |&gt; 
  filter(species == "Gentoo" | species == "Chinstrap")
```

```
## # A tibble: 192 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Gentoo  Biscoe           46.1          13.2              211        4500 fema…
## 2 Gentoo  Biscoe           50            16.3              230        5700 male 
## # … with 190 more rows, and 1 more variable: year &lt;int&gt;
```

- `|` OR

Solution


```r
penguins |&gt; 
  filter(species %in% c("Gentoo", "Chinstrap"))
```

```
## # A tibble: 192 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Gentoo  Biscoe           46.1          13.2              211        4500 fema…
## 2 Gentoo  Biscoe           50            16.3              230        5700 male 
## # … with 190 more rows, and 1 more variable: year &lt;int&gt;
```

---
# `between()`

Problem


```r
penguins |&gt; 
  filter(body_mass_g &gt;= 2000, body_mass_g &lt;= 3000)
```

```
## # A tibble: 11 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Dream            37            16.9              185        3000 fema…
## 2 Adelie  Dream            37.5          18.9              179        2975 &lt;NA&gt; 
## # … with 9 more rows, and 1 more variable: year &lt;int&gt;
```

Solution


```r
penguins |&gt; 
  filter(between(body_mass_g, left = 2000, right = 3000))
```

```
## # A tibble: 11 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Dream            37            16.9              185        3000 fema…
## 2 Adelie  Dream            37.5          18.9              179        2975 &lt;NA&gt; 
## # … with 9 more rows, and 1 more variable: year &lt;int&gt;
```

---
# Partial string matches

Problem

Want to filter by partial text match

solution: `stringr` package


```r
penguins |&gt; 
  filter(str_detect(species, "G"))
```

```
## # A tibble: 124 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Gentoo  Biscoe           46.1          13.2              211        4500 fema…
## 2 Gentoo  Biscoe           50            16.3              230        5700 male 
## # … with 122 more rows, and 1 more variable: year &lt;int&gt;
```

Regular expressions for more powerful matching.

---
# Mutating columns with mutate()

Make a new column or change an existing column


```r
penguins |&gt; mutate(
  species = tolower(species),
  body_mass_kg = body_mass_g/1000,
  bill_ratio = bill_length_mm/bill_depth_mm
  )
```

```
## # A tibble: 344 × 10
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;chr&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 adelie  Torge…           39.1          18.7              181        3750 male 
## 2 adelie  Torge…           39.5          17.4              186        3800 fema…
## # … with 342 more rows, and 3 more variables: year &lt;int&gt;, body_mass_kg &lt;dbl&gt;,
## #   bill_ratio &lt;dbl&gt;
```

---
# Useful functions for mutate

- mutate character columns with `stringr`, `glue`
- mutate factor columns with `forcats`
- mutate dates with `lubridate`

---
# Summarising data with summarise


```r
penguins |&gt; 
  summarise(
    max_mass = max(body_mass_g, na.rm = TRUE),
    mean_bill_length = mean(bill_length_mm, na.rm = TRUE)
  )
```

```
## # A tibble: 1 × 2
##   max_mass mean_bill_length
##      &lt;int&gt;            &lt;dbl&gt;
## 1     6300             43.9
```

Useful functions

- limits `min()` `max()`
- centre `mean()` `median()`
- spread `sd()`
- number `n()` `n_distinct()`

---
# Grouping data


```r
penguins |&gt; 
  group_by(species, island)
```

```
## # A tibble: 344 × 8
## # Groups:   species, island [5]
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge…           39.1          18.7              181        3750 male 
## 2 Adelie  Torge…           39.5          17.4              186        3800 fema…
## # … with 342 more rows, and 1 more variable: year &lt;int&gt;
```

Mutate and summarise now work per group


---
# Mutating grouped data

Analysis per group


```r
penguins |&gt; 
  group_by(species) |&gt; 
  mutate(bill_length_mean = mean(bill_length_mm, na.rm = TRUE),
         bill_length_centred = bill_length_mm - bill_length_mean)
```

```
## # A tibble: 344 × 10
## # Groups:   species [3]
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge…           39.1          18.7              181        3750 male 
## 2 Adelie  Torge…           39.5          17.4              186        3800 fema…
## # … with 342 more rows, and 3 more variables: year &lt;int&gt;,
## #   bill_length_mean &lt;dbl&gt;, bill_length_centred &lt;dbl&gt;
```


---
# Summarising grouped data

Summary per group


```r
penguins |&gt; 
  group_by(species) |&gt; 
  summarise(
    max_mass = max(body_mass_g),
    mean_bill_length = mean(bill_length_mm),
   .groups = "drop"
  )
```

```
## # A tibble: 3 × 3
##   species   max_mass mean_bill_length
##   &lt;fct&gt;        &lt;int&gt;            &lt;dbl&gt;
## 1 Adelie          NA             NA  
## 2 Chinstrap     4800             48.8
## 3 Gentoo          NA             NA
```


---
# Counting rows


```r
penguins |&gt; 
  count(species, island, sex)
```

```
## # A tibble: 13 × 4
##   species island sex        n
##   &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;  &lt;int&gt;
## 1 Adelie  Biscoe female    22
## 2 Adelie  Biscoe male      22
## # … with 11 more rows
```

```r
penguins |&gt; 
  group_by(species, island, sex) |&gt; 
  summarise(n = n(), .groups = "drop")
```

```
## # A tibble: 13 × 4
##   species island sex        n
##   &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;  &lt;int&gt;
## 1 Adelie  Biscoe female    22
## 2 Adelie  Biscoe male      22
## # … with 11 more rows
```

---
# Mutating joins

Merge two tibbles

&lt;img src="figures/left-join.gif" title="Animation showing how left_join merges two data frames by a common variable." alt="Animation showing how left_join merges two data frames by a common variable."  /&gt;

---
# left_join()

.pull-left[

```r
band_members
```

```
## # A tibble: 3 × 2
##   name  band   
##   &lt;chr&gt; &lt;chr&gt;  
## 1 Mick  Stones 
## 2 John  Beatles
## 3 Paul  Beatles
```

```r
band_instruments
```

```
## # A tibble: 3 × 2
##   name  plays 
##   &lt;chr&gt; &lt;chr&gt; 
## 1 John  guitar
## 2 Paul  bass  
## 3 Keith guitar
```
]

.pull_right[

```r
band_members %&gt;% 
  left_join(band_instruments, by = "name")
```

```
## # A tibble: 3 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 Mick  Stones  &lt;NA&gt;  
## 2 John  Beatles guitar
## 3 Paul  Beatles bass
```

## Other joins

- `inner_join()`
- `full_join()`

]

---
# Filtering joins


```r
#semi join
band_members %&gt;% 
  semi_join(band_instruments, by = "name")
```

```
## # A tibble: 2 × 2
##   name  band   
##   &lt;chr&gt; &lt;chr&gt;  
## 1 John  Beatles
## 2 Paul  Beatles
```

```r
#anti join
band_members %&gt;% 
  anti_join(band_instruments, by = "name")
```

```
## # A tibble: 1 × 2
##   name  band  
##   &lt;chr&gt; &lt;chr&gt; 
## 1 Mick  Stones
```


---
# Tidy code

&lt;blockquote class="twitter-tweet" data-lang="en" width = "550"&gt;&lt;p lang="en" dir="ltr"&gt;The only way to write good code is to write tons of shitty code first. Feeling shame about bad code stops you from getting to good code&lt;/p&gt;&amp;mdash; Hadley Wickham (@hadleywickham) &lt;a href="https://twitter.com/hadleywickham/status/589068687669243905"&gt;17 April 2015&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;

---
# Why?

 - Makes code easier to read
 - Makes code easier to debug

Make your own style - but be consistent

---
# Naming Things

&gt;    “There are only two hard things in Computer Science: cache invalidation and naming things.”

&gt;    — Phil Karlton

 - Names can contain letter numbers "_"" and "."
 - Names must begin with a letter or "."
 - Avoid using names of existing functions - confusing
 - Make names concise yet meaningful
 - Reserved words include TRUE, for, if

---
# White-space is free! 

Place spaces

- around infix operators (`|&gt;`, `+`, `-`, `&lt;-`, ) 
- around `=` in function calls
- after commas not before
- but `1:10` and `dplyr::select()`

### Good

```r
average &lt;- mean(feet / 12 + inches, na.rm = TRUE)
```
### Bad

```r
average&lt;-mean(feet/12+inches,na.rm=TRUE)
```

---
# Split long commands over multiple lines


```r
penguins |&gt; 
  group_by(species) |&gt; 
  summarise(
    max_mass = max(body_mass_g),
    mean_bill_length = mean(bill_length_mm),
   .groups = "drop"
  )
```

---
# Indentation makes code more readable

### Good

```r
positive &lt;- function(x) {
  if (is.null(dim(x))) {
    x[x &gt; 0]
  } else{
    x[, colSums(x) &gt; 0, drop  = FALSE]
  }
}
```

### Bad

```r
positive &lt;- function(x){
if(is.null(dim(x)))
{x[x &gt;0]} 
else{
x[, colSums(x) &gt; 0, drop  = FALSE]
}}
```

---
# Assignment

Use &lt;-, not =, for assignment.

### Good

```r
x &lt;- 5
```
### Bad

```r
x = 5
```

---
# Comments

Use # to start comments.

Help you and others to understand what you did

Comments should explain the why, not the what.

Use comments for navigation

```r
#### Load data ####
...
#### Plot data ####
...
```

---
# Split analyses over multiple files

Long scripts become difficult to navigate

Fix by moving parts of the code into different files

For example: 

 - data import code to "loadData.R"
 - functions to "functions.R"

Import with  

```r
source("loadData.R")
source("functions.R")
```

---
# Don't repeat yourself

Repeated code is hard to maintain

Make repeated code into functions.


```r
my_fun &lt;- function(arg1) {arg1 ^ 2}
my_fun(7)
```
Single place to maintain

---
# Further reading

.pull-left[
Wickham and Grolemund (2017) [R for Data Science](https://r4ds.had.co.nz/)

Wickham, H. Style Guide _Advanced R_
[http://adv-r.had.co.nz/Style.html](http://adv-r.had.co.nz/Style.html)
]
.pull-right[
&lt;img src="figures/r4ds.png" title="Front page of the R for Data Science book with a kākāpō." alt="Front page of the R for Data Science book with a kākāpō."  /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
