<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Descriptive statistics and Introduction to statistical inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="Richard J. Telford (Richard.Telford@uib.no)" />
    <meta name="date" content="2021-11-02" />
    <script src="lecture_5_descriptive_files/header-attrs-2.10/header-attrs.js"></script>
    <link href="lecture_5_descriptive_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="lecture_5_descriptive_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="lecture_5_descriptive_files/clipboard-2.0.6/clipboard.min.js"></script>
    <link href="lecture_5_descriptive_files/shareon-1.4.1/shareon.min.css" rel="stylesheet" />
    <script src="lecture_5_descriptive_files/shareon-1.4.1/shareon.min.js"></script>
    <link href="lecture_5_descriptive_files/xaringanExtra-shareagain-0.2.6/shareagain.css" rel="stylesheet" />
    <script src="lecture_5_descriptive_files/xaringanExtra-shareagain-0.2.6/shareagain.js"></script>
    <link href="lecture_5_descriptive_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="lecture_5_descriptive_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Descriptive statistics and Introduction to statistical inference
## Bio300B Lecture 4
### Richard J. Telford (<a href="mailto:Richard.Telford@uib.no" class="email">Richard.Telford@uib.no</a>)
### Institutt for biovitenskap, UiB
### 02 November 2021

---

  
  &lt;style type="text/css"&gt;
  .remark-slide-content {
    font-size: 24px;
    padding: 1em 4em 1em 4em;
  }
&lt;/style&gt;
  




# Describing a distribution

![](lecture_5_descriptive_files/figure-html/a-dist-1.png)&lt;!-- --&gt;

---
# Midpoint

![](lecture_5_descriptive_files/figure-html/midpoint-1.png)&lt;!-- --&gt;

---
## Mean

.pull-left[
![](lecture_5_descriptive_files/figure-html/mean-1.png)&lt;!-- --&gt;
]
.pull-right[
`$$\overline{x} = \frac{\sum_{i=1}^n x_i}{n}$$` 
- Sum of all observations divided by number of observations
- Centre of gravity of the data
- `mean()`
]

---
## Median

![](lecture_5_descriptive_files/figure-html/median-anim-1.gif)&lt;!-- --&gt;
- Sort from minimum to maximum
- Observation in the middle is the median
- `median()`

---
## Mean vs Median


![](lecture_5_descriptive_files/figure-html/biomass-plot-1.png)&lt;!-- --&gt;

---
## Mean vs Median


![](lecture_5_descriptive_files/figure-html/biomass-plot2-1.png)&lt;!-- --&gt;

---
## Calculating Mean and Median in R


```r
vec &lt;- c(56.7, 57.2, 62.7, 56.4, 60.8)
# mean of a vector
mean(vec)
```

```
## [1] 58.76
```

```r
# median of a vector
median(vec)
```

```
## [1] 57.2
```

---
Use `na.rm = TRUE` to remove missing values. 


```r
vec &lt;- c(56.7, 57.2, 62.7, 56.4, 60.8, NA)
# mean of a vector with NA
mean(vec)
```

```
## [1] NA
```

```r
# mean of a vector excluding NA
mean(vec, na.rm = TRUE)
```

```
## [1] 58.76
```

---


```r
# median of a column
median(penguins$bill_length_mm, na.rm = TRUE)
```

```
## [1] 44.45
```

```r
# or
penguins |&gt; 
  summarise(med = median(bill_length_mm, na.rm = TRUE))
```

```
## # A tibble: 1 × 1
##     med
##   &lt;dbl&gt;
## 1  44.4
```

```r
#mean of a column with a grouping variable
penguins |&gt; 
  group_by(species) |&gt; 
  summarise(med = median(bill_length_mm, na.rm = TRUE))
```

```
## # A tibble: 3 × 2
##   species     med
##   &lt;fct&gt;     &lt;dbl&gt;
## 1 Adelie     38.8
## 2 Chinstrap  49.6
## 3 Gentoo     47.3
```


---
# Spread

![](lecture_5_descriptive_files/figure-html/spread-1.png)&lt;!-- --&gt;

---
## Minimum, maximum and range

- `min()`
- `max()`

Range is difference between smallest and largest.


```r
# range() gives smallest and largest values
range(penguins$bill_length_mm, na.rm = TRUE)
```

```
## [1] 32.1 59.6
```

```r
# calculate range as
max(penguins$bill_length_mm, na.rm = TRUE) - 
min(penguins$bill_length_mm, na.rm = TRUE)
```

```
## [1] 27.5
```

```r
# or
diff(range(penguins$bill_length_mm, na.rm = TRUE))
```

```
## [1] 27.5
```


---
## Variance

  
The average squared distance around the mean

### Population variance

`$$\sigma^2 = \frac{\sum_{i=1}^n (x_i - \mu)^2}{n}$$`
Where `\(\mu\)` is the population mean.

### Sample variance

`$$s^2 = \frac{\sum_{i=1}^n (x_i - \overline{x})^2}{n-1}$$`
Where `\(\overline{x}\)` is the sample mean.  
`var()`

---
## Standard deviation



.pull-left[Square root of the variance 
`$$s = \sqrt{s^2}$$`
`$$s  = \sqrt{\frac{\sum_{i=1}^n (x_i - \overline{x})^2}{n-1}}$$`
Same units as variable

`sqrt(var())`  
`sd()`  

]
.pull_right[
![](lecture_5_descriptive_files/figure-html/sd-1.png)&lt;!-- --&gt;
]

---
![](lecture_5_descriptive_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;

---
# Higher moments

## Skew

.pull-left[
![](lecture_5_descriptive_files/figure-html/biomassplot-again-1.png)&lt;!-- --&gt;
]
.pull-right[
Right skew  
positive skew 
`e1071::skewness()`
]

---
## Kurtosis

![](lecture_5_descriptive_files/figure-html/kurtosis-1.png)&lt;!-- --&gt;


heavy tails

`e1071::kurtosis()`

---
# Making inferences about the population

Sample: 123 Gentoo penguins

Population: All Gentoo penguins in the Palmer Archipelago.

What can we infer about the population from the sample?

---
# Uncertainty in the mean


![](lecture_5_descriptive_files/figure-html/pop-1.png)&lt;!-- --&gt;

Population of 1,000,000 indviduals

Large (100 individuals) or small (20 individuals) samples

---
Histograms of samples

![](lecture_5_descriptive_files/figure-html/samples-1.gif)&lt;!-- --&gt;

Histogram of sample means

![](lecture_5_descriptive_files/figure-html/sample-means-1.png)&lt;!-- --&gt;

---
# Standard error of the mean

Standard deviation divided by square root of number of observations

`$$SE = \frac{s}{\sqrt{n}}$$`
Large n - small SE - reliable estimate of mean 

Small n - large SE - less reliable estimate of mean 

---
# Confidence interval

If experiment repeated many times, confidence level represents the proportion of confidence intervals that contain the true value of the unknown population parameter.

So 95% confidence interval will contain true value in 95% of repeat experiments

Easily misunderstood.

(Bayesian credibility intervals are much more intuitive)

---
## Confidence interval of the mean

95% confidence interval

Mean `\(\pm\)` 1.96 * SE

Why 1.96?

![](lecture_5_descriptive_files/figure-html/se1.96-1.png)&lt;!-- --&gt;

Grey area is 95% of the normal distribution 

---

Estimated means with 95% confidence interval for different sample sizes
![](lecture_5_descriptive_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;

---
# Choosing a statistical test

1) What is the hypothesis?  
2) What is the underlying distribution of your response variable?  
3) What type of the predictor(s)?  
4) What type of observational or experimental design do you have?

---
## The hypothesis

The statistical hypothesis needs to match your scientific hypothesis

Hypothesis example:  
H&lt;sub&gt;0&lt;/sub&gt;: The bill length (mm) of Gentoo penguins does not depend on
sex.

---
## The predictors

- Categorical (sex, species)
- Continuous (body mass)
- both (with &gt; 1 predictor)

Need to know so we can
code predictor variables and
interpret the output of our
models.

---
## The response

- Continuous (bill length)
- count (number of penguins)
- binary (sex, survived/died)
- proportion (8 out of 10)


Statistical model
families (lm, lme, glm etc.)
differ in assumptions about
the underlying distribution
of the response variable.

---
## Gaussian (Normal) distribution

Often assumed for continuous distributions, body mass, egg shell thickness

![](lecture_5_descriptive_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;
---
## Poisson distribution

Count data

Shape varies with mean

![](lecture_5_descriptive_files/figure-html/poisson-1.png)&lt;!-- --&gt;

---
# Experimental design

- Independent observations?
- time series?
- clustered design?

&lt;img src="figures/46695412244_66616e8523_c.jpg" width="50%" /&gt;

---
## Key 

- Independent observations
   - Continuous response = linear models (`lm()`, `t.test()`)
   - Count/binary/proportion = generalised linear models (`glm()`)


- Clustered observations
   - Continuous response = linear mixed effect models (`lme()`, `lmer()`)
   - Count/binary/proportion = generalised linear mixed effect models (`glmer()`)
   
---
# A t-test

Compare means

H&lt;sub&gt;0&lt;/sub&gt;: Bill length does not depend on sex in Gentoo penguins

![](lecture_5_descriptive_files/figure-html/t-test-plot-1.png)&lt;!-- --&gt;

---
## t-test in R


```r
gentoo &lt;- penguins |&gt; 
  filter(species == "Gentoo")|&gt; 
  drop_na(bill_length_mm, sex)

mod1 &lt;- t.test(bill_length_mm ~ sex, data = gentoo)
```

---

```
## 
## 	Welch Two Sample t-test
## 
## data:  bill_length_mm by sex
## t = -8.8798, df = 111.31, p-value = 1.315e-14
## alternative hypothesis: true difference in means between group female and group male is not equal to 0
## 95 percent confidence interval:
##  -4.782478 -3.037477
## sample estimates:
## mean in group female   mean in group male 
##             45.56379             49.47377
```

---
# P values

Often misinterpreted
 
 - Not a measure of effect size or practical significance
 - Not the probability that hypothesis is true
 - Strongly affected by sample size

_If there were actually no effect (if the true difference between means were zero) then the probability of observing a value for the difference equal to, or greater than, that actually observed would be p=0.05._

Many assumptions

Confidence intervals are more interpretable

---
# Type 1 and type 2 errors

Type 1 error - Null hypothesis is incorrectly rejected - false positive

Type 2 error - Null hypothesis is incorrectly accepted - false negative

---
## One sided Z-test 

![](lecture_5_descriptive_files/figure-html/TP-FP-1.png)&lt;!-- --&gt;


---
## The need for power

With little power:

- May not be able to reject H&lt;sub&gt;0&lt;/sub&gt; when it is false
- Exaggerate effect size

Lots of power

- Probably can reject  H&lt;sub&gt;0&lt;/sub&gt;
    when it is false
-  More precise estimates of effect size
-   More expensive

Need to do power analysis before experiment.


---
## Components of a power analysis

-  Effect size
-   Type I error rate (significance level - conventionally set to 0.05)
-   Type II error rate (conventionally aim for 0.8)
-   Number of observations

Can solve for any of these

Typically want to know how many observations needed.


---
## Analytic power analysis

Some power tests in base R.

 - `power.t.test`
 - `power.anova.test`
 - `power.prop.test`

More in `pwr` package

---
## Power t test


```r
library("pwr")
pow &lt;- pwr.t.test(d = 0.5, sig.level = 0.05, power = 0.8)
pow
```

```
## 
##      Two-sample t test power calculation 
## 
##               n = 63.76561
##               d = 0.5
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group
```

Effect size is Cohen's d `\(d = \frac{\mu_1 - \mu_2}{\sigma}\)`

---

![](lecture_5_descriptive_files/figure-html/pwr-plot, echo-1.png)&lt;!-- --&gt;

---
- Power test should be done before experimental work to determine sample size
- Analytical and simulation approaches are possible
- Key challenge is estimating effect size
  - existing estimates are likely biased
  - minimum interesting effect size
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
